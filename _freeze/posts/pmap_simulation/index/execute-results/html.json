{
  "hash": "2393edbb9676de8a31a713239ae16479",
  "result": {
    "markdown": "---\ntitle: Statistical simulation using functional programming with `pmap()`\ndescription: The `purrr` package is a powerful tool for functional programming. This post explores how the `pmap()` function can be used for statistical simulations.\nauthor: Max Rohde\ndate: 06/11/2022\nimage: preview.png\ncode-fold: show\ndraft: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load packages\nlibrary(tidyverse)\n\n# Utilities\nlibrary(patchwork)\nlibrary(kableExtra)\nlibrary(glue)\n\n# Set global ggplot theme\ntheme_set(cowplot::theme_cowplot(font_size=14,\n                                 font_family = \"Source Sans Pro\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngenerate_text <- function(animal, color, month){\n \n  text <- glue(\"My favorite animal is {animal}\n                My favorite color is {color}\n                My favorite month is {month}\")\n  \n  return(text)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngenerate_text(\"cat\", \"blue\", \"October\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nMy favorite animal is cat\nMy favorite color is blue\nMy favorite month is October\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using `map()` can do 1 argument at a time\nanimals <- c(\"cat\", \"dog\", \"fish\")\ncolors <- c(\"red\", \"green\", \"blue\")\nmonths <- c(\"August\", \"October\", \"December\")\n\n# Mapping over animals and setting color and month to be fixed\nmap(animals, ~generate_text(.x, color=\"blue\", month = \"October\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nMy favorite animal is cat\nMy favorite color is blue\nMy favorite month is October\n\n[[2]]\nMy favorite animal is dog\nMy favorite color is blue\nMy favorite month is October\n\n[[3]]\nMy favorite animal is fish\nMy favorite color is blue\nMy favorite month is October\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfavorites_df <- tibble(animal = animals,\n                       color = colors,\n                       month = months)\n\nfavorites_list <- list(animal = animals,\n                       color = colors,\n                       month = months)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfavorites_df\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> animal </th>\n   <th style=\"text-align:left;\"> color </th>\n   <th style=\"text-align:left;\"> month </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> cat </td>\n   <td style=\"text-align:left;\"> red </td>\n   <td style=\"text-align:left;\"> August </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dog </td>\n   <td style=\"text-align:left;\"> green </td>\n   <td style=\"text-align:left;\"> October </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> fish </td>\n   <td style=\"text-align:left;\"> blue </td>\n   <td style=\"text-align:left;\"> December </td>\n  </tr>\n</tbody>\n</table>\n\n</div>\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfavorites_list\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$animal\n[1] \"cat\"  \"dog\"  \"fish\"\n\n$color\n[1] \"red\"   \"green\" \"blue\" \n\n$month\n[1] \"August\"   \"October\"  \"December\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Match by name\npmap(favorites_df, generate_text)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nMy favorite animal is cat\nMy favorite color is red\nMy favorite month is August\n\n[[2]]\nMy favorite animal is dog\nMy favorite color is green\nMy favorite month is October\n\n[[3]]\nMy favorite animal is fish\nMy favorite color is blue\nMy favorite month is December\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify by location, not name\npmap(favorites_df, ~generate_text(animal = ..1, color=..2, month=..3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nMy favorite animal is cat\nMy favorite color is red\nMy favorite month is August\n\n[[2]]\nMy favorite animal is dog\nMy favorite color is green\nMy favorite month is October\n\n[[3]]\nMy favorite animal is fish\nMy favorite color is blue\nMy favorite month is December\n```\n:::\n:::\n\n\n### 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Without names, location is used (giving the wrong order in this case)\nfavorites_list = list(colors,\n                      months,\n                      animals)\n\npmap(favorites_list, generate_text)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nMy favorite animal is red\nMy favorite color is August\nMy favorite month is cat\n\n[[2]]\nMy favorite animal is green\nMy favorite color is October\nMy favorite month is dog\n\n[[3]]\nMy favorite animal is blue\nMy favorite color is December\nMy favorite month is fish\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# If names are given, they take precedence over location\nfavorites_list = list(color = colors,\n                    month = months,\n                    animal = animals)\n\npmap(favorites_list, generate_text)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nMy favorite animal is cat\nMy favorite color is red\nMy favorite month is August\n\n[[2]]\nMy favorite animal is dog\nMy favorite color is green\nMy favorite month is October\n\n[[3]]\nMy favorite animal is fish\nMy favorite color is blue\nMy favorite month is December\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cool example from documentation\n\n# Use `...` to absorb unused components of input list .l\ndf <- data.frame(\n  x = 1:3,\n  y = 10:12,\n  z = letters[1:3]\n)\nplus <- function(x, y) x + y\n## Not run: \n# this won't work\n# pmap(df, plus)\n\n## End(Not run)\n# but this will\nplus2 <- function(x, y, ...) x + y\npmap_dbl(df, plus2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 11 13 15\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}