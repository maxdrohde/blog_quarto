<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.545">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Max Rohde">
<meta name="dcterms.date" content="2022-05-11">
<meta name="description" content="An in-depth dive into the workings of logistic regression.">
<title>Max Rohde - Logistic regression (by hand)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>
    .quarto-title-block .quarto-title-banner {
      color: black;
background: #f1f3f5;
    }
    </style>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Max Rohde - Logistic regression (by hand)">
<meta name="twitter:description" content="An in-depth dive into the workings of logistic regression.">
<meta name="twitter:image" content="preview.png">
<meta name="twitter:creator" content="@max_d_rohde">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Max Rohde</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.pdf">Resume</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../anim.html">Animations</a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Logistic regression (by hand)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          An in-depth dive into the workings of logistic regression.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Max Rohde </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 11, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li>
<a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
<li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory data analysis</a></li>
  </ul>
</li>
  <li><a href="#logistic-regression-overview" id="toc-logistic-regression-overview" class="nav-link" data-scroll-target="#logistic-regression-overview">Logistic regression overview</a></li>
  <li><a href="#logistic-regression-with-glm" id="toc-logistic-regression-with-glm" class="nav-link" data-scroll-target="#logistic-regression-with-glm">Logistic regression with <code>glm()</code></a></li>
  <li><a href="#logistic-regression-with-optim" id="toc-logistic-regression-with-optim" class="nav-link" data-scroll-target="#logistic-regression-with-optim">Logistic regression with <code>optim()</code></a></li>
  <li><a href="#logistic-regression-with-gradient-descent" id="toc-logistic-regression-with-gradient-descent" class="nav-link" data-scroll-target="#logistic-regression-with-gradient-descent">Logistic regression with gradient descent</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/maxdrohde/blog_quarto/edit/main/posts/logistic-regresstion-by-hand/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/maxdrohde/blog_quarto/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Load packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com">gganimate</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue">glue</a></span><span class="op">)</span>

<span class="co"># Set global ggplot theme</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span>font_size<span class="op">=</span><span class="fl">14</span>,
                                 font_family <span class="op">=</span> <span class="st">"Source Sans Pro"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level1 page-columns page-full"><h1>Overview</h1>
<div class="page-columns page-full"><p>Logistic regression is a method for estimating the probability that an observation is in one of two classes given a vector of covariates. For example, given various demographic characteristics (age, sex, etc…), we can estimate the probability that a person owns a home or not. Important predictors would likely be age and level of income. The probabilities returned by the model can then be used for classification based on a cutoff (e.g., 0.5 is a common choice) or used for decision making based on more complex decision rules<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn1" role="doc-endnote"><p><sup>1</sup>&nbsp;This <a href="https://www.fharrell.com/post/classification/">article</a> goes into more detail on the difference between prediction of probabilities and classification.</p></li></div></div>
<p>In this post, we’ll explore how logistic regression works by implementing it by hand using a few different methods. It can be bit of a black box using the built-in functions in R, so implementing algorithms by hand can aid understanding, even though it’s not practical for data analysis projects.</p>
</section><section id="data" class="level1 page-columns page-full"><h1>Data</h1>
<p>As an example dataset, we will use the Palmer Penguins data. The data includes measurements on three penguins species from an island in the Palmer Archipelago.</p>
<p>We’ll load the data and save it as a data frame <code>df</code>.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Load and rename data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then we will</p>
<ul>
<li>filter to two of the penguin species: Adelie and Gentoo</li>
<li>create a binary variable, <code>adelie</code> corresponding to 1 for Adelie and 0 for Gentoo</li>
<li>select a subset of columns to keep</li>
</ul>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelie"</span>, <span class="st">"Gentoo"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>adelie <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">adelie</span>, <span class="va">bill_length_mm</span><span class="op">:</span><span class="va">body_mass_g</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="exploratory-data-analysis" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory data analysis</h2>
<p>You can explore the raw data below.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page-right">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; "><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;"> species </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> adelie </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> bill_length_mm </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> bill_depth_mm </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> flipper_length_mm </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> body_mass_g </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.1 </td>
   <td style="text-align:right;"> 18.7 </td>
   <td style="text-align:right;"> 181 </td>
   <td style="text-align:right;"> 3750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.5 </td>
   <td style="text-align:right;"> 17.4 </td>
   <td style="text-align:right;"> 186 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.3 </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 3250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.7 </td>
   <td style="text-align:right;"> 19.3 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 3450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.3 </td>
   <td style="text-align:right;"> 20.6 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.9 </td>
   <td style="text-align:right;"> 17.8 </td>
   <td style="text-align:right;"> 181 </td>
   <td style="text-align:right;"> 3625 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.2 </td>
   <td style="text-align:right;"> 19.6 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 4675 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34.1 </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 3475 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.0 </td>
   <td style="text-align:right;"> 20.2 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 4250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.8 </td>
   <td style="text-align:right;"> 17.1 </td>
   <td style="text-align:right;"> 186 </td>
   <td style="text-align:right;"> 3300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.8 </td>
   <td style="text-align:right;"> 17.3 </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 3700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.1 </td>
   <td style="text-align:right;"> 17.6 </td>
   <td style="text-align:right;"> 182 </td>
   <td style="text-align:right;"> 3200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.6 </td>
   <td style="text-align:right;"> 21.2 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34.6 </td>
   <td style="text-align:right;"> 21.1 </td>
   <td style="text-align:right;"> 198 </td>
   <td style="text-align:right;"> 4400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.6 </td>
   <td style="text-align:right;"> 17.8 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.7 </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 3450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.5 </td>
   <td style="text-align:right;"> 20.7 </td>
   <td style="text-align:right;"> 197 </td>
   <td style="text-align:right;"> 4500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34.4 </td>
   <td style="text-align:right;"> 18.4 </td>
   <td style="text-align:right;"> 184 </td>
   <td style="text-align:right;"> 3325 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 46.0 </td>
   <td style="text-align:right;"> 21.5 </td>
   <td style="text-align:right;"> 194 </td>
   <td style="text-align:right;"> 4200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.8 </td>
   <td style="text-align:right;"> 18.3 </td>
   <td style="text-align:right;"> 174 </td>
   <td style="text-align:right;"> 3400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.7 </td>
   <td style="text-align:right;"> 18.7 </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 3600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.9 </td>
   <td style="text-align:right;"> 19.2 </td>
   <td style="text-align:right;"> 189 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.2 </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.8 </td>
   <td style="text-align:right;"> 17.2 </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.3 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.6 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 183 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.5 </td>
   <td style="text-align:right;"> 17.9 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.9 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 172 </td>
   <td style="text-align:right;"> 3150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.5 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 3950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.5 </td>
   <td style="text-align:right;"> 16.7 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 3250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.2 </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.5 </td>
   <td style="text-align:right;"> 17.8 </td>
   <td style="text-align:right;"> 188 </td>
   <td style="text-align:right;"> 3300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.9 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 184 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.4 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 3325 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.2 </td>
   <td style="text-align:right;"> 21.1 </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 4150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.8 </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.2 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 180 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.6 </td>
   <td style="text-align:right;"> 19.3 </td>
   <td style="text-align:right;"> 181 </td>
   <td style="text-align:right;"> 3300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.8 </td>
   <td style="text-align:right;"> 19.1 </td>
   <td style="text-align:right;"> 184 </td>
   <td style="text-align:right;"> 4650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.5 </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 182 </td>
   <td style="text-align:right;"> 3150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.8 </td>
   <td style="text-align:right;"> 18.4 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.0 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 186 </td>
   <td style="text-align:right;"> 3100 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 44.1 </td>
   <td style="text-align:right;"> 19.7 </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 4400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.0 </td>
   <td style="text-align:right;"> 16.9 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.6 </td>
   <td style="text-align:right;"> 18.8 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 4600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.1 </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 182 </td>
   <td style="text-align:right;"> 3425 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.5 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 179 </td>
   <td style="text-align:right;"> 2975 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.0 </td>
   <td style="text-align:right;"> 17.9 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.3 </td>
   <td style="text-align:right;"> 21.2 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 4150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.6 </td>
   <td style="text-align:right;"> 17.7 </td>
   <td style="text-align:right;"> 186 </td>
   <td style="text-align:right;"> 3500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.1 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 188 </td>
   <td style="text-align:right;"> 4300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.0 </td>
   <td style="text-align:right;"> 17.9 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.0 </td>
   <td style="text-align:right;"> 19.5 </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 4050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34.5 </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 2900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.4 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.0 </td>
   <td style="text-align:right;"> 17.5 </td>
   <td style="text-align:right;"> 186 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.6 </td>
   <td style="text-align:right;"> 18.8 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.5 </td>
   <td style="text-align:right;"> 16.6 </td>
   <td style="text-align:right;"> 181 </td>
   <td style="text-align:right;"> 2850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.6 </td>
   <td style="text-align:right;"> 19.1 </td>
   <td style="text-align:right;"> 194 </td>
   <td style="text-align:right;"> 3750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.7 </td>
   <td style="text-align:right;"> 16.9 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.3 </td>
   <td style="text-align:right;"> 21.1 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 4400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.6 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.1 </td>
   <td style="text-align:right;"> 18.2 </td>
   <td style="text-align:right;"> 192 </td>
   <td style="text-align:right;"> 4050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.4 </td>
   <td style="text-align:right;"> 17.1 </td>
   <td style="text-align:right;"> 184 </td>
   <td style="text-align:right;"> 2850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.6 </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 192 </td>
   <td style="text-align:right;"> 3950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.5 </td>
   <td style="text-align:right;"> 16.2 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 3350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.1 </td>
   <td style="text-align:right;"> 19.1 </td>
   <td style="text-align:right;"> 188 </td>
   <td style="text-align:right;"> 4100 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.9 </td>
   <td style="text-align:right;"> 16.6 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.8 </td>
   <td style="text-align:right;"> 19.4 </td>
   <td style="text-align:right;"> 198 </td>
   <td style="text-align:right;"> 4450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 33.5 </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.7 </td>
   <td style="text-align:right;"> 18.4 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.6 </td>
   <td style="text-align:right;"> 17.2 </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 45.8 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 197 </td>
   <td style="text-align:right;"> 4150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.5 </td>
   <td style="text-align:right;"> 17.5 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.8 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 4250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.9 </td>
   <td style="text-align:right;"> 16.8 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.2 </td>
   <td style="text-align:right;"> 19.4 </td>
   <td style="text-align:right;"> 184 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.2 </td>
   <td style="text-align:right;"> 16.1 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.1 </td>
   <td style="text-align:right;"> 19.1 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 4000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34.6 </td>
   <td style="text-align:right;"> 17.2 </td>
   <td style="text-align:right;"> 189 </td>
   <td style="text-align:right;"> 3200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.9 </td>
   <td style="text-align:right;"> 17.6 </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 4700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.7 </td>
   <td style="text-align:right;"> 18.8 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.1 </td>
   <td style="text-align:right;"> 19.4 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 4200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.3 </td>
   <td style="text-align:right;"> 17.8 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.3 </td>
   <td style="text-align:right;"> 20.3 </td>
   <td style="text-align:right;"> 194 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.3 </td>
   <td style="text-align:right;"> 19.5 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.9 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 189 </td>
   <td style="text-align:right;"> 3500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.3 </td>
   <td style="text-align:right;"> 19.2 </td>
   <td style="text-align:right;"> 189 </td>
   <td style="text-align:right;"> 3950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.9 </td>
   <td style="text-align:right;"> 18.8 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.7 </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 202 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.1 </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 205 </td>
   <td style="text-align:right;"> 4300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34.0 </td>
   <td style="text-align:right;"> 17.1 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.6 </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 186 </td>
   <td style="text-align:right;"> 4450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.2 </td>
   <td style="text-align:right;"> 17.3 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.8 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 4300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.1 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.3 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 4350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 33.1 </td>
   <td style="text-align:right;"> 16.1 </td>
   <td style="text-align:right;"> 178 </td>
   <td style="text-align:right;"> 2900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 43.2 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 192 </td>
   <td style="text-align:right;"> 4100 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.0 </td>
   <td style="text-align:right;"> 17.9 </td>
   <td style="text-align:right;"> 192 </td>
   <td style="text-align:right;"> 3725 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.0 </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 203 </td>
   <td style="text-align:right;"> 4725 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.7 </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 183 </td>
   <td style="text-align:right;"> 3075 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.8 </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 4250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.9 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 2925 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.7 </td>
   <td style="text-align:right;"> 18.9 </td>
   <td style="text-align:right;"> 184 </td>
   <td style="text-align:right;"> 3550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.6 </td>
   <td style="text-align:right;"> 17.2 </td>
   <td style="text-align:right;"> 199 </td>
   <td style="text-align:right;"> 3750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.2 </td>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.1 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 181 </td>
   <td style="text-align:right;"> 3175 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 43.2 </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 197 </td>
   <td style="text-align:right;"> 4775 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.1 </td>
   <td style="text-align:right;"> 16.5 </td>
   <td style="text-align:right;"> 198 </td>
   <td style="text-align:right;"> 3825 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 45.6 </td>
   <td style="text-align:right;"> 20.3 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 4600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.7 </td>
   <td style="text-align:right;"> 17.7 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 3200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.2 </td>
   <td style="text-align:right;"> 19.5 </td>
   <td style="text-align:right;"> 197 </td>
   <td style="text-align:right;"> 4275 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.6 </td>
   <td style="text-align:right;"> 20.7 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 42.7 </td>
   <td style="text-align:right;"> 18.3 </td>
   <td style="text-align:right;"> 196 </td>
   <td style="text-align:right;"> 4075 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.6 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 188 </td>
   <td style="text-align:right;"> 2900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.3 </td>
   <td style="text-align:right;"> 20.5 </td>
   <td style="text-align:right;"> 199 </td>
   <td style="text-align:right;"> 3775 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.7 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 189 </td>
   <td style="text-align:right;"> 3350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.1 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 189 </td>
   <td style="text-align:right;"> 3325 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.2 </td>
   <td style="text-align:right;"> 17.2 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.7 </td>
   <td style="text-align:right;"> 19.8 </td>
   <td style="text-align:right;"> 198 </td>
   <td style="text-align:right;"> 3500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.2 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 176 </td>
   <td style="text-align:right;"> 3450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.4 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 202 </td>
   <td style="text-align:right;"> 3875 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.2 </td>
   <td style="text-align:right;"> 15.9 </td>
   <td style="text-align:right;"> 186 </td>
   <td style="text-align:right;"> 3050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.6 </td>
   <td style="text-align:right;"> 19.0 </td>
   <td style="text-align:right;"> 199 </td>
   <td style="text-align:right;"> 4000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.8 </td>
   <td style="text-align:right;"> 17.6 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3275 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.5 </td>
   <td style="text-align:right;"> 18.3 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 4300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.0 </td>
   <td style="text-align:right;"> 17.1 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 44.1 </td>
   <td style="text-align:right;"> 18.0 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.5 </td>
   <td style="text-align:right;"> 17.9 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3325 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 43.1 </td>
   <td style="text-align:right;"> 19.2 </td>
   <td style="text-align:right;"> 197 </td>
   <td style="text-align:right;"> 3500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.8 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 3500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.5 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 199 </td>
   <td style="text-align:right;"> 4475 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 38.1 </td>
   <td style="text-align:right;"> 17.6 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3425 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.1 </td>
   <td style="text-align:right;"> 17.5 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 35.6 </td>
   <td style="text-align:right;"> 17.5 </td>
   <td style="text-align:right;"> 191 </td>
   <td style="text-align:right;"> 3175 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.2 </td>
   <td style="text-align:right;"> 20.1 </td>
   <td style="text-align:right;"> 200 </td>
   <td style="text-align:right;"> 3975 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.0 </td>
   <td style="text-align:right;"> 16.5 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.7 </td>
   <td style="text-align:right;"> 17.9 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 4250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.2 </td>
   <td style="text-align:right;"> 17.1 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 3400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.6 </td>
   <td style="text-align:right;"> 17.2 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3475 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 32.1 </td>
   <td style="text-align:right;"> 15.5 </td>
   <td style="text-align:right;"> 188 </td>
   <td style="text-align:right;"> 3050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 40.7 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 3725 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.3 </td>
   <td style="text-align:right;"> 16.8 </td>
   <td style="text-align:right;"> 192 </td>
   <td style="text-align:right;"> 3000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.0 </td>
   <td style="text-align:right;"> 18.7 </td>
   <td style="text-align:right;"> 185 </td>
   <td style="text-align:right;"> 3650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 39.2 </td>
   <td style="text-align:right;"> 18.6 </td>
   <td style="text-align:right;"> 190 </td>
   <td style="text-align:right;"> 4250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.6 </td>
   <td style="text-align:right;"> 18.4 </td>
   <td style="text-align:right;"> 184 </td>
   <td style="text-align:right;"> 3475 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.0 </td>
   <td style="text-align:right;"> 17.8 </td>
   <td style="text-align:right;"> 195 </td>
   <td style="text-align:right;"> 3450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 37.8 </td>
   <td style="text-align:right;"> 18.1 </td>
   <td style="text-align:right;"> 193 </td>
   <td style="text-align:right;"> 3750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 36.0 </td>
   <td style="text-align:right;"> 17.1 </td>
   <td style="text-align:right;"> 187 </td>
   <td style="text-align:right;"> 3700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Adelie </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 41.5 </td>
   <td style="text-align:right;"> 18.5 </td>
   <td style="text-align:right;"> 201 </td>
   <td style="text-align:right;"> 4000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.1 </td>
   <td style="text-align:right;"> 13.2 </td>
   <td style="text-align:right;"> 211 </td>
   <td style="text-align:right;"> 4500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 16.3 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 5700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.7 </td>
   <td style="text-align:right;"> 14.1 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 15.2 </td>
   <td style="text-align:right;"> 218 </td>
   <td style="text-align:right;"> 5700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.6 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.5 </td>
   <td style="text-align:right;"> 13.5 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.4 </td>
   <td style="text-align:right;"> 14.6 </td>
   <td style="text-align:right;"> 211 </td>
   <td style="text-align:right;"> 4800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.7 </td>
   <td style="text-align:right;"> 15.3 </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 5200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.3 </td>
   <td style="text-align:right;"> 13.4 </td>
   <td style="text-align:right;"> 209 </td>
   <td style="text-align:right;"> 4400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.8 </td>
   <td style="text-align:right;"> 15.4 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 40.9 </td>
   <td style="text-align:right;"> 13.7 </td>
   <td style="text-align:right;"> 214 </td>
   <td style="text-align:right;"> 4650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.0 </td>
   <td style="text-align:right;"> 16.1 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 5550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.5 </td>
   <td style="text-align:right;"> 13.7 </td>
   <td style="text-align:right;"> 214 </td>
   <td style="text-align:right;"> 4650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.4 </td>
   <td style="text-align:right;"> 14.6 </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 5850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.8 </td>
   <td style="text-align:right;"> 14.6 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.3 </td>
   <td style="text-align:right;"> 15.7 </td>
   <td style="text-align:right;"> 217 </td>
   <td style="text-align:right;"> 5850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 42.0 </td>
   <td style="text-align:right;"> 13.5 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.2 </td>
   <td style="text-align:right;"> 15.2 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 6300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.2 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 209 </td>
   <td style="text-align:right;"> 4800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.7 </td>
   <td style="text-align:right;"> 15.1 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 5350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.2 </td>
   <td style="text-align:right;"> 14.3 </td>
   <td style="text-align:right;"> 218 </td>
   <td style="text-align:right;"> 5700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.1 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.5 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 4400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.3 </td>
   <td style="text-align:right;"> 15.8 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 42.9 </td>
   <td style="text-align:right;"> 13.1 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.1 </td>
   <td style="text-align:right;"> 15.1 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5100 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.5 </td>
   <td style="text-align:right;"> 14.3 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 4100 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.8 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.2 </td>
   <td style="text-align:right;"> 14.3 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 15.3 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 5550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.3 </td>
   <td style="text-align:right;"> 15.3 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 5250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 42.8 </td>
   <td style="text-align:right;"> 14.2 </td>
   <td style="text-align:right;"> 209 </td>
   <td style="text-align:right;"> 4700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.1 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 207 </td>
   <td style="text-align:right;"> 5050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 59.6 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 6050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.1 </td>
   <td style="text-align:right;"> 14.8 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 5150 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.4 </td>
   <td style="text-align:right;"> 16.3 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 5400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 42.6 </td>
   <td style="text-align:right;"> 13.7 </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 4950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.4 </td>
   <td style="text-align:right;"> 17.3 </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 5250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.0 </td>
   <td style="text-align:right;"> 13.6 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 4350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.7 </td>
   <td style="text-align:right;"> 15.7 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 5350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 42.7 </td>
   <td style="text-align:right;"> 13.7 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 3950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.6 </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> 5700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.3 </td>
   <td style="text-align:right;"> 13.7 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.6 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 4750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.5 </td>
   <td style="text-align:right;"> 15.9 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 5550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.6 </td>
   <td style="text-align:right;"> 13.9 </td>
   <td style="text-align:right;"> 217 </td>
   <td style="text-align:right;"> 4900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.5 </td>
   <td style="text-align:right;"> 13.9 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.5 </td>
   <td style="text-align:right;"> 15.9 </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> 5400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.9 </td>
   <td style="text-align:right;"> 13.3 </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 5100 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.2 </td>
   <td style="text-align:right;"> 15.8 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.6 </td>
   <td style="text-align:right;"> 14.2 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.5 </td>
   <td style="text-align:right;"> 14.1 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 5300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.1 </td>
   <td style="text-align:right;"> 14.4 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.1 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> 5000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.5 </td>
   <td style="text-align:right;"> 14.4 </td>
   <td style="text-align:right;"> 217 </td>
   <td style="text-align:right;"> 4900 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.0 </td>
   <td style="text-align:right;"> 15.4 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 5050 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.8 </td>
   <td style="text-align:right;"> 13.9 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 4300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.5 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 5000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.2 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 4450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.4 </td>
   <td style="text-align:right;"> 15.3 </td>
   <td style="text-align:right;"> 224 </td>
   <td style="text-align:right;"> 5550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.3 </td>
   <td style="text-align:right;"> 13.8 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 4200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.2 </td>
   <td style="text-align:right;"> 14.9 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 5300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.7 </td>
   <td style="text-align:right;"> 13.9 </td>
   <td style="text-align:right;"> 214 </td>
   <td style="text-align:right;"> 4400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 54.3 </td>
   <td style="text-align:right;"> 15.7 </td>
   <td style="text-align:right;"> 231 </td>
   <td style="text-align:right;"> 5650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.8 </td>
   <td style="text-align:right;"> 14.2 </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 4700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.8 </td>
   <td style="text-align:right;"> 16.8 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 5700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.2 </td>
   <td style="text-align:right;"> 14.4 </td>
   <td style="text-align:right;"> 214 </td>
   <td style="text-align:right;"> 4650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.5 </td>
   <td style="text-align:right;"> 16.2 </td>
   <td style="text-align:right;"> 229 </td>
   <td style="text-align:right;"> 5800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.5 </td>
   <td style="text-align:right;"> 14.2 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 4700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.7 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 223 </td>
   <td style="text-align:right;"> 5550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.7 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 4750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.4 </td>
   <td style="text-align:right;"> 15.6 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 5000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.2 </td>
   <td style="text-align:right;"> 15.6 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 5100 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.5 </td>
   <td style="text-align:right;"> 14.8 </td>
   <td style="text-align:right;"> 217 </td>
   <td style="text-align:right;"> 5200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.4 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 4700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.6 </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 5800 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.5 </td>
   <td style="text-align:right;"> 14.2 </td>
   <td style="text-align:right;"> 209 </td>
   <td style="text-align:right;"> 4600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 51.1 </td>
   <td style="text-align:right;"> 16.3 </td>
   <td style="text-align:right;"> 220 </td>
   <td style="text-align:right;"> 6000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.2 </td>
   <td style="text-align:right;"> 13.8 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 4750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.2 </td>
   <td style="text-align:right;"> 16.4 </td>
   <td style="text-align:right;"> 223 </td>
   <td style="text-align:right;"> 5950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.1 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 212 </td>
   <td style="text-align:right;"> 4625 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 52.5 </td>
   <td style="text-align:right;"> 15.6 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 5450 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.4 </td>
   <td style="text-align:right;"> 14.6 </td>
   <td style="text-align:right;"> 212 </td>
   <td style="text-align:right;"> 4725 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 15.9 </td>
   <td style="text-align:right;"> 224 </td>
   <td style="text-align:right;"> 5350 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.9 </td>
   <td style="text-align:right;"> 13.8 </td>
   <td style="text-align:right;"> 212 </td>
   <td style="text-align:right;"> 4750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.8 </td>
   <td style="text-align:right;"> 17.3 </td>
   <td style="text-align:right;"> 228 </td>
   <td style="text-align:right;"> 5600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.4 </td>
   <td style="text-align:right;"> 14.4 </td>
   <td style="text-align:right;"> 218 </td>
   <td style="text-align:right;"> 4600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 51.3 </td>
   <td style="text-align:right;"> 14.2 </td>
   <td style="text-align:right;"> 218 </td>
   <td style="text-align:right;"> 5300 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.5 </td>
   <td style="text-align:right;"> 14.0 </td>
   <td style="text-align:right;"> 212 </td>
   <td style="text-align:right;"> 4875 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 52.1 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 5550 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.5 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 218 </td>
   <td style="text-align:right;"> 4950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 52.2 </td>
   <td style="text-align:right;"> 17.1 </td>
   <td style="text-align:right;"> 228 </td>
   <td style="text-align:right;"> 5400 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.5 </td>
   <td style="text-align:right;"> 14.5 </td>
   <td style="text-align:right;"> 212 </td>
   <td style="text-align:right;"> 4750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.5 </td>
   <td style="text-align:right;"> 16.1 </td>
   <td style="text-align:right;"> 224 </td>
   <td style="text-align:right;"> 5650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.5 </td>
   <td style="text-align:right;"> 14.7 </td>
   <td style="text-align:right;"> 214 </td>
   <td style="text-align:right;"> 4850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.8 </td>
   <td style="text-align:right;"> 15.7 </td>
   <td style="text-align:right;"> 226 </td>
   <td style="text-align:right;"> 5200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.4 </td>
   <td style="text-align:right;"> 15.8 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 4925 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.9 </td>
   <td style="text-align:right;"> 14.6 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 4875 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.4 </td>
   <td style="text-align:right;"> 14.4 </td>
   <td style="text-align:right;"> 203 </td>
   <td style="text-align:right;"> 4625 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 51.1 </td>
   <td style="text-align:right;"> 16.5 </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> 5250 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.5 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 4850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 55.9 </td>
   <td style="text-align:right;"> 17.0 </td>
   <td style="text-align:right;"> 228 </td>
   <td style="text-align:right;"> 5600 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.2 </td>
   <td style="text-align:right;"> 15.5 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 4975 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.1 </td>
   <td style="text-align:right;"> 15.0 </td>
   <td style="text-align:right;"> 228 </td>
   <td style="text-align:right;"> 5500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.3 </td>
   <td style="text-align:right;"> 13.8 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 4725 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.8 </td>
   <td style="text-align:right;"> 16.1 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 5500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 41.7 </td>
   <td style="text-align:right;"> 14.7 </td>
   <td style="text-align:right;"> 210 </td>
   <td style="text-align:right;"> 4700 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 53.4 </td>
   <td style="text-align:right;"> 15.8 </td>
   <td style="text-align:right;"> 219 </td>
   <td style="text-align:right;"> 5500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.3 </td>
   <td style="text-align:right;"> 14.0 </td>
   <td style="text-align:right;"> 208 </td>
   <td style="text-align:right;"> 4575 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.1 </td>
   <td style="text-align:right;"> 15.1 </td>
   <td style="text-align:right;"> 209 </td>
   <td style="text-align:right;"> 5500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.5 </td>
   <td style="text-align:right;"> 15.2 </td>
   <td style="text-align:right;"> 216 </td>
   <td style="text-align:right;"> 5000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.8 </td>
   <td style="text-align:right;"> 15.9 </td>
   <td style="text-align:right;"> 229 </td>
   <td style="text-align:right;"> 5950 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 43.5 </td>
   <td style="text-align:right;"> 15.2 </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 4650 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 51.5 </td>
   <td style="text-align:right;"> 16.3 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 5500 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.2 </td>
   <td style="text-align:right;"> 14.1 </td>
   <td style="text-align:right;"> 217 </td>
   <td style="text-align:right;"> 4375 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 55.1 </td>
   <td style="text-align:right;"> 16.0 </td>
   <td style="text-align:right;"> 230 </td>
   <td style="text-align:right;"> 5850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 44.5 </td>
   <td style="text-align:right;"> 15.7 </td>
   <td style="text-align:right;"> 217 </td>
   <td style="text-align:right;"> 4875 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 48.8 </td>
   <td style="text-align:right;"> 16.2 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 6000 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 47.2 </td>
   <td style="text-align:right;"> 13.7 </td>
   <td style="text-align:right;"> 214 </td>
   <td style="text-align:right;"> 4925 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 46.8 </td>
   <td style="text-align:right;"> 14.3 </td>
   <td style="text-align:right;"> 215 </td>
   <td style="text-align:right;"> 4850 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 50.4 </td>
   <td style="text-align:right;"> 15.7 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 5750 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 45.2 </td>
   <td style="text-align:right;"> 14.8 </td>
   <td style="text-align:right;"> 212 </td>
   <td style="text-align:right;"> 5200 </td>
  </tr>
<tr>
<td style="text-align:left;"> Gentoo </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 49.9 </td>
   <td style="text-align:right;"> 16.1 </td>
   <td style="text-align:right;"> 213 </td>
   <td style="text-align:right;"> 5400 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>The <code><a href="https://rdrr.io/pkg/Hmisc/man/describe.html">Hmisc::describe()</a></code> function can give us a quick summary of the data.</p>
<div class="callout-note column-page-right callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand to view detailed summary statistics for each variable
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/html.html">html</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/describe.html">describe</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript">
<!--
    function expand_collapse(id) {
       var e = document.getElementById(id);
       var f = document.getElementById(id+"_earrows");
       if(e.style.display == 'none'){
          e.style.display = 'block';
          f.innerHTML = '&#9650';
       }
       else {
          e.style.display = 'none';
          f.innerHTML = '&#9660';
       }
    }
//-->
</script><style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: 󅒐
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>
<title>df Descriptives</title>
<font color="MidnightBlue"><div align="center"><span style="font-weight:bold">df <br><br> 6  Variables   274  Observations</span></div></font> <hr class="thinhr">
<span style="font-weight:bold">species</span> <style>
 .hmisctable276540 {
 border: none;
 font-size: 85%;
 }
 .hmisctable276540 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable276540 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable276540">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>2</td>
</tr>
</tbody></table>
<pre style="font-size:85%;"> Value      Adelie Gentoo
 Frequency     151    123
 Proportion  0.551  0.449
 </pre>
 <hr class="thinhr">
<span style="font-weight:bold">adelie</span> <style>
 .hmisctable841636 {
 border: none;
 font-size: 85%;
 }
 .hmisctable841636 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable841636 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable841636">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Sum</th>
<th>Mean</th>
<th>Gmd</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>2</td>
<td>0.742</td>
<td>151</td>
<td>0.5511</td>
<td>0.4966</td>
</tr>
</tbody></table>
<hr class="thinhr">
<span style="font-weight:bold">bill_length_mm</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable385272 {
 border: none;
 font-size: 85%;
 }
 .hmisctable385272 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable385272 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable385272">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>146</td>
<td>1</td>
<td>42.7</td>
<td>5.944</td>
<td>35.43</td>
<td>36.20</td>
<td>38.35</td>
<td>42.00</td>
<td>46.68</td>
<td>49.80</td>
<td>50.73</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 32.1 33.1 33.5 34.0 34.1 ,  <font color="MidnightBlue">highest</font>: 53.4 54.3 55.1 55.9 59.6</span> <hr class="thinhr">
<span style="font-weight:bold">bill_depth_mm</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable592679 {
 border: none;
 font-size: 85%;
 }
 .hmisctable592679 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable592679 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable592679">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>78</td>
<td>1</td>
<td>16.84</td>
<td>2.317</td>
<td>13.80</td>
<td>14.20</td>
<td>15.00</td>
<td>17.00</td>
<td>18.50</td>
<td>19.30</td>
<td>20.03</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 13.1 13.2 13.3 13.4 13.5 ,  <font color="MidnightBlue">highest</font>: 20.6 20.7 21.1 21.2 21.5</span> <hr class="thinhr">
<span style="font-weight:bold">flipper_length_mm</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable415330 {
 border: none;
 font-size: 85%;
 }
 .hmisctable415330 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable415330 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable415330">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>54</td>
<td>0.999</td>
<td>202.2</td>
<td>17.23</td>
<td>181.0</td>
<td>184.0</td>
<td>190.0</td>
<td>198.0</td>
<td>215.0</td>
<td>222.0</td>
<td>226.7</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 172 174 176 178 179 ,  <font color="MidnightBlue">highest</font>: 226 228 229 230 231</span> <hr class="thinhr">
<span style="font-weight:bold">body_mass_g</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable719982 {
 border: none;
 font-size: 85%;
 }
 .hmisctable719982 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable719982 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable719982">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>89</td>
<td>1</td>
<td>4318</td>
<td>962.3</td>
<td>3091</td>
<td>3282</td>
<td>3600</td>
<td>4262</td>
<td>4950</td>
<td>5535</td>
<td>5700</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 2850 2900 2925 2975 3000 ,  <font color="MidnightBlue">highest</font>: 5850 5950 6000 6050 6300</span> <hr class="thinhr">
</div>
</div>
</div>
</div>
</div>
<p>The below plot informs us that Adelie and Gentoo penguins are likely to be easily distinguishable based on the measured features, since there is little overlap between the two species. Because we want to have a bit of a challenge (and because logistic regression doesn’t converge if the classes are perfectly separable), we will predict species based on bill length and body mass.</p>
<div class="cell page-columns page-full">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">species</span><span class="op">)</span>,
                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bill_length_mm"</span>,
                              <span class="st">"bill_depth_mm"</span>,
                              <span class="st">"flipper_length_mm"</span>,
                              <span class="st">"body_mass_g"</span><span class="op">)</span>,
                  title <span class="op">=</span> <span class="st">"Can these features distinguish Adelie and Gentoo penguins?"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page-right">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>In order to help our algorithms converge, we will put our variables on a more common scale by converting bill length to cm and body mass to kg.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">bill_length_cm</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">/</span> <span class="fl">10</span>
<span class="va">df</span><span class="op">$</span><span class="va">body_mass_kg</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span> <span class="op">/</span> <span class="fl">1000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Look at distribution of bill length in cm and body mass in kg</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_cm</span>,bins<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_kg</span>, bins<span class="op">=</span><span class="fl">50</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page-right">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section></section><section id="logistic-regression-overview" class="level1 page-columns page-full"><h1>Logistic regression overview</h1>
<p>Logistic regression is a type of linear model. In statistics, a linear model means linear in the parameters, so we are modeling the output as a linear function of the parameters.</p>
<p>For example, if we were predicting bill length, we could create a linear model where bill length is normally distributed, with a mean determined as a linear function of body mass and species.</p>
<p><span class="math display">\[\begin{gather}
\mu_i = \beta_0 + \beta_1 [\text{Body Mass}]_i + \beta_2 [\text{Species = Adelie}]_i \\
[\text{Bill Length}]_i \sim N(\mu_i, \sigma^2)
\end{gather}\]</span></p>
<p>We have three parameters, <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\beta_2\)</span>. We can determine the likelihood of the data given these parameters. Maximizing the likelihood is the <a href="https://online.stat.psu.edu/stat415/lesson/1/1.2">most common way</a> to estimate the parameters from data. The idea is that we tune the parameters until we find the set of parameters that made the observed data most likely.</p>
<p>However, this won’t quite work if we want to predict a binary outcome like species. We could form a model like this: <span class="math display">\[\begin{gather}
p_i = \beta_0 + \beta_1 [\text{Bill Length}]_i + \beta_2 [\text{Body Mass}]_i \\
[\text{Species}]_i \sim \operatorname{Bernoulli}(p_i)
\end{gather}\]</span> In words, each observation of a penguin is modeled as a Bernoulli random variable, where the probability of being Adelie is a linear function of bill length and body mass. The issue with this model is that if we let the parameters vary, the value of <span class="math inline">\(p_i\)</span> can exceed the range <span class="math inline">\([0,1]\)</span>, which doesn’t make sense if we are trying to model a probability.</p>
<p>The solution is using the expit function:</p>
<p><span class="math display">\[
\operatorname{expit} = \frac{e^{x}}{1+e^{x}}
\]</span></p>
<p>This function takes in a real valued input and transforms it to lie within the range <span class="math inline">\([0,1]\)</span>. The expit function is also called the logistic function, hence the name “logistic regression”.</p>
<p>Let’s try it out in an example.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># This is a naive implementation that can overflow for large x</span>
<span class="co"># expit &lt;- function(x) exp(x) / (1 + exp(x))</span>

<span class="co"># Better to use the built-in version</span>
<span class="va">expit</span> <span class="op">&lt;-</span> <span class="va">plogis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Plot the output of the expit() function for x values between -10 and 10</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">1e5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>,
     <span class="fu">expit</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
     type <span class="op">=</span> <span class="st">"l"</span>,
     main <span class="op">=</span> <span class="st">"Understanding the effect of expit"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We see that (approximately) anything below -5 gets squashed to zero and anything above 5 gets squashed to 1.</p>
<p>We then modify our model to be <span class="math display">\[\begin{gather}
p_i = \operatorname{expit} \left(\beta_0 + \beta_1 [\text{Bill Length}] + \beta_2 [\text{Body Mass}] \right) \\
\text{[Species]} \sim \operatorname{Bernoulli}(p_i)
\end{gather}\]</span> so now <span class="math inline">\(p_i\)</span> is constrained to lie within <span class="math inline">\([0,1]\)</span>. This type of model, where we take a linear function of the parameters and then apply a non-linear function to it, is known as a generalized linear model (GLM).</p>
<p>The likelihood contribution of a single observation is <span class="math inline">\(p_i\)</span> if it is Adelie and <span class="math inline">\(1-p_i\)</span> if it is Gentoo, which we can write as</p>
<p><span class="math display">\[
\text{Likelihood}_i = p_i^{\text{Adelie}} (1-p_i)^{1 - \text{Adelie}}
\]</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>This form of writing the Bernoulli PMF works because if Adelie = 1, then <span class="math inline">\(\text{Likelihood}_i = p_i^{1} (1-p_i)^{1 - 1} = p_i\)</span> and if Adelie = 0, then <span class="math inline">\(\text{Likelihood}_i = p_i^{0} (1-p_i)^{1 - 0} = 1-p_i\)</span>.</p>
</div></div><p>and therefore the log-likelihood contribution of a single observation is</p>
<p><span class="math display">\[
\text{Log-Likelihood}_i = [\text{[Adelie]}_i \times \log(p_i)] + [(1 - \text{[Adelie]}_i) \times \log(1-p_i)]
\]</span></p>
<p>The log-likelihood of the entire dataset is just the sum of all the individual log-likelihoods, since we are assuming independent observations, so we have</p>
<p><span class="math display">\[
\text{Log-Likelihood} = \sum_{i=1}^{n} \left[ [\text{[Adelie]}_i \times \log(p_i)] + [(1 - \text{[Adelie]}_i) \times \log(1-p_i)] \right]
\]</span></p>
<p>and now substituting in <span class="math inline">\(p_i\)</span> in terms of the parameters, we have <span class="math display">\[\begin{align}
\text{Log-Likelihood} &amp;= \underbrace{\sum_{i=1}^{n} [[\text{[Adelie]}_i \times \log(\operatorname{expit} \left(\beta_0 + \beta_1 [\text{Bill Length}]_i + \beta_2 [\text{Body Mass}]_i \right))]}_{\text{Contribution from Adelie observations}} \\ &amp;+ \underbrace{[(1 - \text{[Adelie]}_i) \times \log(1-\operatorname{expit} \left(\beta_0 + \beta_1 [\text{Bill Length}]_i + \beta_2 [\text{Body Mass}]_i \right))]}_{\text{Contribution from Gentoo observations}}]
\end{align}\]</span></p>
<p>We can then pick <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\beta_2\)</span> to maximize this log-likelihood function, or as is often done in practice, minimize the negative log-likelihood function. We will need to do this with numerical methods, rather than obtaining an analytical solution with calculus, since no closed-form solution exists.</p>
</section><section id="logistic-regression-with-glm" class="level1 page-columns page-full"><h1>Logistic regression with <code>glm()</code>
</h1>
<p>Before we implement logistic regression by hand, we will use the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function in R as a baseline. Under the hood, R uses the <a href="https://en.wikipedia.org/wiki/Scoring_algorithm">Fisher Scoring Algorithm</a> to obtain the maximum likelihood estimates.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Fit the logistic regression model</span>
<span class="va">model_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">adelie</span> <span class="op">~</span> <span class="va">bill_length_cm</span> <span class="op">+</span> <span class="va">body_mass_kg</span>,
                 family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,
                 data<span class="op">=</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now that we have fit the model, let’s look at the predictions of the model. We can make a grid of covariate values, and ask the model to give us the predicted probability of Species = Adelie for each one.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Create a grid of values on which to evaluate probabilities</span>
<span class="va">grid</span> <span class="op">&lt;-</span>
<span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span><span class="op">(</span>bill_length_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_cm</span><span class="op">)</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_cm</span><span class="op">)</span><span class="op">+</span><span class="fl">0.2</span>, <span class="fl">0.001</span><span class="op">)</span>,
         body_mass_kg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_kg</span><span class="op">)</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_kg</span><span class="op">)</span><span class="op">+</span><span class="fl">0.1</span>, <span class="fl">0.005</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We use the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function to obtain the predicted probabilities. Using <code>type = "response"</code> specifies that we want the predictions on the probability scale (i.e., after passing the linear predictor through the <code>expit</code> function.).</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">grid</span><span class="op">$</span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model_glm</span>, <span class="va">grid</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; "><table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> bill_length_cm </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> body_mass_kg </th>
   <th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;"> predicted </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.750 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.755 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.760 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.765 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.770 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.775 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.780 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.785 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.790 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.795 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.800 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.805 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.810 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.815 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.820 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.825 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.830 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.835 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.840 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.845 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.850 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.855 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.860 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.865 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.870 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.875 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.880 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.885 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.890 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.895 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.900 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.905 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.910 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.915 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.920 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.925 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.930 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.935 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.940 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.945 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.950 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.955 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.960 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.965 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.970 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.975 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.980 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.985 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.990 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 2.995 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.000 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.005 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.010 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.015 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.020 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.025 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.030 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.035 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.040 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.045 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.050 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.055 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.060 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.065 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.070 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.075 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.080 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.085 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.090 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.095 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.100 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.105 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.110 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.115 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.120 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.125 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.130 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.135 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.140 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.145 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.150 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.155 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.160 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.165 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.170 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.175 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.180 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.185 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.190 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.195 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.200 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.205 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.210 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.215 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.220 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.225 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.230 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.235 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.240 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3.01 </td>
   <td style="text-align:right;"> 3.245 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<p>Now that we have the predictions, let’s plot them and overlay the data with their true labels. The model looks to be performing pretty well!</p>
<div class="cell page-columns page-full">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">grid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_length_cm</span>,
      y<span class="op">=</span><span class="va">body_mass_kg</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span>, color<span class="op">=</span><span class="st">"black"</span>, shape<span class="op">=</span><span class="fl">21</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span>,
                       limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Probability of Adelie\n"</span>,
       color <span class="op">=</span> <span class="st">"Species"</span>,
       x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>,
       y <span class="op">=</span> <span class="st">"Body mass (g)"</span>,
       title <span class="op">=</span> <span class="st">"Visualizing the predictions of the logistic regression model"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page-right">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section><section id="logistic-regression-with-optim" class="level1 page-columns page-full"><h1>Logistic regression with <code>optim()</code>
</h1>
<p>Now that we know what to expect after using <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>, let’s implement logistic regression by hand.</p>
<div class="page-columns page-full"><p>Recall that we would like to numerically determine the beta values that minimize the negative log-likelihood. The <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> function in R is a general-purpose function for minimizing functions<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn2" role="doc-endnote"><p><sup>2</sup>&nbsp;This <a href="https://youtu.be/Qvye1wDa0kk">short video</a> is a good introduction to <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>.</p></li></div></div>
<div class="page-columns page-full"><p><code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> has an algorithm called <a href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">Nelder-Mead</a> that searches the parameter space and converges on the minimum value. It is a direct search method that only requires the negative log-likelihood function as input (as opposed to gradient based methods that require specified the gradients of the negative log-likelihood function). This animation demonstrates the Nelder-Mead algorithm in action<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn3" role="doc-endnote"><p><sup>3</sup>&nbsp;Sourced from <a href="https://commons.wikimedia.org/wiki/File:Nelder-Mead_Rosenbrock.gif">here</a></p></li></div></div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><video src="nelder_mead.mp4" class="img-fluid" controls=""><a href="nelder_mead.mp4">Video</a></video></p>
<p></p><figcaption aria-hidden="true" class="figure-caption margin-caption">Nelder-Mead animation</figcaption><p></p>
</figure>
</div>
<p>To use <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>, we create a function that takes as input the parameters and returns the negative log-likelihood. The below code is a translation of the mathematical notation from above.</p>
<div class="cell column-page-right">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">neg_loglikelihood_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co"># optim() expects the parameters as a single vector, so we set the coefficients</span>
  <span class="co"># as the elements of a vector called `parameters`</span>
  <span class="va">b0</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">b2</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  
  <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">b0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b1</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_cm</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b2</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_kg</span><span class="op">)</span>
  
  <span class="co"># Likelihood for each observation</span>
  <span class="co"># If the observation is Adelie, then the likelihood is the probability of Adelie</span>
  <span class="co"># If the observation is not Adelie (i.e., Gentoo), then the likelihood is the probability of not Adelie</span>
  <span class="co"># which is 1 - P(Adelie)</span>
  <span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adelie</span><span class="op">==</span><span class="fl">1</span>,
                       <span class="fu">expit</span><span class="op">(</span><span class="va">linear_predictor</span><span class="op">)</span>,
                       <span class="fl">1</span><span class="op">-</span><span class="fu">expit</span><span class="op">(</span><span class="va">linear_predictor</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co"># Log-likelihood for each observation</span>
  <span class="va">log_likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span>
  
  <span class="co"># Joint log-likelihood for all the observations. Note the sum because</span>
  <span class="co"># multiplication is addition on the log-scale</span>
  <span class="va">total_log_likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">log_likelihood</span><span class="op">)</span>
  
  <span class="co"># the optim() function only minimizes, so we return the negative log-likelihood</span>
  <span class="co"># and then maximize it</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">-</span><span class="va">total_log_likelihood</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As an example, we can pass in <span class="math inline">\(\beta_0 = 1, \beta_1 = 2, \beta_2 = 3\)</span> and see what the negative log-likelihood is.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">neg_loglikelihood_function</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3164.666</code></pre>
</div>
</div>
<p>Because the negative log-likelihood is very high, we know that these are poor choices for the parameter values.</p>
<p>We can visualize the negative log-likelihood function for a variety of values. Since there are 3 parameters in our model, and we cannot visualize in 4D, we set <span class="math inline">\(\beta_0 = 58.075\)</span>, which was the optimized value found by <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and we can visualize how the negative log-likelihood varies with <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Create a grid of parameter values</span>
<span class="va">grid</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span><span class="op">(</span>
    b0 <span class="op">=</span> <span class="fl">58.075</span>,
    b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12</span>, <span class="op">-</span><span class="fl">7</span>, length.out<span class="op">=</span><span class="fl">1e2</span><span class="op">)</span>,
    b2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">2</span>, length.out<span class="op">=</span><span class="fl">1e2</span><span class="op">)</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Evaluate the negative log-likelihood for each parameter value</span>
<span class="va">grid</span><span class="op">$</span><span class="va">neg_loglikelihood</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap_dbl</a></span><span class="op">(</span><span class="va">grid</span>,
           <span class="op">~</span><span class="fu">neg_loglikelihood_function</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">..1</span>, <span class="va">..2</span>, <span class="va">..3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Show a heatmap of the negative log-likelihood with contour lines</span>
<span class="va">grid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">b1</span>,
      y<span class="op">=</span><span class="va">b2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">neg_loglikelihood</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>z<span class="op">=</span><span class="va">neg_loglikelihood</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">50</span>, size<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"point"</span>, x<span class="op">=</span><span class="op">-</span><span class="fl">8.999</span>, y<span class="op">=</span><span class="op">-</span><span class="fl">4.363</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Negative log-likelihood\n"</span>,
       x <span class="op">=</span> <span class="st">"Beta 1"</span>,
       y <span class="op">=</span> <span class="st">"Beta 2"</span>,
       title <span class="op">=</span> <span class="st">"Visualizing the negative log-likelihood function"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page-right">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>To use <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code>, we pass in the starting parameter values to <code>par</code> and the function to be minimized (the negative log-likelihood) to <code>fn</code>. Finally, we’ll specify <code>method="Nelder-Mead"</code>.</p>
<div class="cell column-page-right">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">optim_results</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span>par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,                      <span class="co"># Initial values</span>
        fn <span class="op">=</span> <span class="va">neg_loglikelihood_function</span>,   <span class="co"># Objective function to be minimized</span>
        method<span class="op">=</span><span class="st">"Nelder-Mead"</span><span class="op">)</span>              <span class="co"># Optimization method</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The maximum likelihood estimates are stored in the <code>$par</code> attribute of the <code>optim</code> object</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">optim_results</span><span class="op">$</span><span class="va">par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 58.080999 -9.001399 -4.362164</code></pre>
</div>
</div>
<p>which we can compare with the coefficients obtained from <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>, and we see that they match quite closely.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_glm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) bill_length_cm   body_mass_kg 
     58.074991      -8.998692      -4.363412 </code></pre>
</div>
</div>
<div class="page-columns page-full"><p>The below animation demonstrates the path of the Nelder-Mead function<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. As stated above, for the purpose of the animation, we set the optimized value of <span class="math inline">\(\beta_0 = 58.075\)</span> and we can visualize how the negative log-likelihood is optimized with respect to <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>.</p><div class="no-row-height column-margin column-container"><li id="fn4" role="doc-endnote"><p><sup>4</sup>&nbsp;The code for this animation is long, so it is not included here, but can be viewed in the source code of the Quarto document.</p></li></div></div>
<div class="cell">

</div>
<div class="column-page-right page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><video src="nelder_mead_path.mp4" class="img-fluid" controls=""><a href="nelder_mead_path.mp4">Video</a></video></p>
<p></p><figcaption aria-hidden="true" class="figure-caption margin-caption">Animation of the path taken by the Nelder Mead algorithm</figcaption><p></p>
</figure>
</div>
</div>
</section><section id="logistic-regression-with-gradient-descent" class="level1 page-columns page-full"><h1>Logistic regression with gradient descent</h1>
<p>Going one step further, instead of using a built-in optimization algorithm, let’s maximize the likelihood ourselves using gradient descent. If you need a refresher, I have written a blog post on gradient descent which you can find <a href="https://maximilianrohde.com/posts/gradient-descent-pt1/">here</a>.</p>
<p>We need the gradient of the negative-log likelihood function. The slope with respect to the jth parameter is given by</p>
<p><span class="math display">\[\begin{align}
[\operatorname{expit}(\mathbf{\beta} \cdot \mathbf{x})-\mathbf{y}] \mathbf{x}_{j} \implies [\hat{\mathbf{y}}-\mathbf{y}] \mathbf{x}_{j}
\end{align}\]</span> so then the gradient can be written as <span class="math display">\[\begin{align}
\mathbf{X}^T [\operatorname{expit}(\mathbf{X} \mathbf{\beta}) - \mathbf{y}]
\end{align}\]</span> or equivalently <span class="math display">\[\begin{align}
\mathbf{X}^T (\hat{\mathbf{y}} - \mathbf{y})
\end{align}\]</span></p>
<p>You can find a nice derivation of the derivative of the negative log-likelihood for logistic regression <a href="https://web.stanford.edu/~jurafsky/slp3/5.pdf">here</a>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Another approach is to use automatic differentiation. Automatic differentiation can be used to obtain gradients for arbitrary functions, and is used heavily in deep learning. An example to do this in R using the <code>torch</code> library is shown <a href="https://rgiordan.github.io/code/2022/04/01/rtorch_example.html">here</a>.</p>
</div></div><p>We implement the above equations in the following function for the gradient.</p>
<div class="cell column-page-right">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">gradient</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># Given a vector of parameters values, return the current gradient</span>
  
  <span class="va">b0</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">b2</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  
  <span class="co"># Define design matrix</span>
  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>,
                 <span class="va">df</span><span class="op">$</span><span class="va">bill_length_cm</span>,
                 <span class="va">df</span><span class="op">$</span><span class="va">body_mass_kg</span><span class="op">)</span>
  
  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>
  
  <span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="fu">expit</span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">beta</span><span class="op">)</span>
  
  <span class="va">gradient</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">y_hat</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">adelie</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gradient</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>We must specify <code>type="2"</code> in the <code><a href="https://rdrr.io/r/base/norm.html">norm()</a></code> function to specify that we want the Euclidean length of the vector.</p>
</div></div><p>Now we implement the gradient descent algorithm. We stop if the difference between the new parameter vector and old parameter vector is less than <span class="math inline">\(10^{-6}\)</span>.</p>
<div class="cell column-page-right" data-hash="index_cache/html/unnamed-chunk-26_40b8a03d62e0eae1d9503ed3817c914b">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">777</span><span class="op">)</span>

<span class="va">step_size</span> <span class="op">&lt;-</span> <span class="fl">0.001</span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>
<span class="va">iter</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="kw">while</span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">iter</span> <span class="op">&lt;-</span> <span class="va">iter</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="va">current_gradient</span> <span class="op">&lt;-</span> <span class="fu">gradient</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>
  
  <span class="va">theta_new</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">-</span> <span class="op">(</span><span class="va">step_size</span> <span class="op">*</span> <span class="va">current_gradient</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html">norm</a></span><span class="op">(</span><span class="va">theta</span> <span class="op">-</span> <span class="va">theta_new</span>, type<span class="op">=</span><span class="st">"2"</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-6</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">break</span>
  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span>
    <span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">theta_new</span>
  <span class="op">}</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"Number of iterations: {iter}"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Number of iterations: 541366</code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"Final parameter values: {as.numeric(theta)}"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Final parameter values: 57.9692967372787
Final parameter values: -8.98174736147028
Final parameter values: -4.35607256440227</code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"`glm()` parameter values (for comparison): {as.numeric(coef(model_glm))}"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>`glm()` parameter values (for comparison): 58.0749906489601
`glm()` parameter values (for comparison): -8.99869242178258
`glm()` parameter values (for comparison): -4.36341215126915</code></pre>
</div>
</div>
<p>Again, we see that the results are very close to the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> results.</p>
</section><section id="conclusion" class="level1"><h1>Conclusion</h1>
<p>Hopefully this post was helpful for understanding the inner workings of logistic regression and how the principles can be extended to other types of models. For example, Poisson regression is another type of generalized linear model just like logistic regression, where in that case we use the <code>exp</code> function instead of the <code>expit</code> function to constrain parameter values to lie in the range <span class="math inline">\([0, \infty]\)</span>.</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><script src="https://utteranc.es/client.js" repo="maxdrohde/blog_quarto" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb32" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Logistic regression (by hand)</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> An in-depth dive into the workings of logistic regression.</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Max Rohde</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 05/11/2022</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> preview.png</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> show</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="an">freeze:</span><span class="co"> false</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="an">citation-location:</span><span class="co"> margin</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global ggplot theme</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(cowplot<span class="sc">::</span><span class="fu">theme_cowplot</span>(<span class="at">font_size=</span><span class="dv">14</span>,</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">font_family =</span> <span class="st">"Source Sans Pro"</span>))</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>Logistic regression is a method for estimating the probability that an observation is in one of two classes given a vector of covariates. For example, given various demographic characteristics (age, sex, etc...), we can estimate the probability that a person owns a home or not. Important predictors would likely be age and level of income. The probabilities returned by the model can then be used for classification based on a cutoff (e.g., 0.5 is a common choice) or used for decision making based on more complex decision rules^<span class="co">[</span><span class="ot">This [article](https://www.fharrell.com/post/classification/) goes into more detail on the difference between prediction of probabilities and classification.</span><span class="co">]</span>. </span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>In this post, we'll explore how logistic regression works by implementing it by hand using a few different methods. It can be bit of a black box using the built-in functions in R, so implementing algorithms by hand can aid understanding, even though it's not practical for data analysis projects.</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>As an example dataset, we will use the Palmer Penguins data. The data includes measurements on three penguins species from an island in the Palmer Archipelago.</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>We'll load the data and save it as a data frame <span class="in">`df`</span>.</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and rename data</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(penguins)</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> penguins</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>Then we will</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>filter to two of the penguin species: Adelie and Gentoo</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>create a binary variable, <span class="in">`adelie`</span> corresponding to 1 for Adelie and 0 for Gentoo</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>select a subset of columns to keep</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Adelie"</span>, <span class="st">"Gentoo"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">adelie =</span> <span class="fu">as.integer</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, adelie, bill_length_mm<span class="sc">:</span>body_mass_g) <span class="sc">%&gt;%</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploratory data analysis</span></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>You can explore the raw data below.</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"300px"</span>)</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>The <span class="in">`Hmisc::describe()`</span> function can give us a quick summary of the data.</span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>:::{.callout-note .column-page-right collapse="true"}</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expand to view detailed summary statistics for each variable</span></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span>(<span class="fu">describe</span>(df))</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a>The below plot informs us that Adelie and Gentoo penguins are likely to be easily distinguishable based on the measured features, since there is little overlap between the two species. Because we want to have a bit of a challenge (and because logistic regression doesn't converge if the classes are perfectly separable), we will predict species based on bill length and body mass.</span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color=</span>species),</span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a>                  <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"bill_length_mm"</span>,</span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"bill_depth_mm"</span>,</span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"flipper_length_mm"</span>,</span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"body_mass_g"</span>),</span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"Can these features distinguish Adelie and Gentoo penguins?"</span>) <span class="sc">+</span></span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Dark2"</span>)</span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a>In order to help our algorithms converge, we will put our variables on a more common scale by converting bill length to cm and body mass to kg.</span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>bill_length_cm <span class="ot">&lt;-</span> df<span class="sc">$</span>bill_length_mm <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>body_mass_kg <span class="ot">&lt;-</span> df<span class="sc">$</span>body_mass_g <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at distribution of bill length in cm and body mass in kg</span></span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(df<span class="sc">$</span>bill_length_cm,<span class="at">bins=</span><span class="dv">50</span>) <span class="sc">+</span> <span class="fu">qplot</span>(df<span class="sc">$</span>body_mass_kg, <span class="at">bins=</span><span class="dv">50</span>)</span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression overview</span></span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a>Logistic regression is a type of linear model. In statistics, a linear model means linear in the parameters, so we are modeling the output as a linear function of the parameters.</span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a>For example, if we were predicting bill length, we could create a linear model where bill length is normally distributed, with a mean determined as a linear function of body mass and species.</span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a>\begin{gather}</span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a>\mu_i = \beta_0 + \beta_1 <span class="co">[</span><span class="ot">\text{Body Mass}</span><span class="co">]</span>_i + \beta_2 [\text{Species = Adelie}]_i <span class="sc">\\</span></span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">\text{Bill Length}</span><span class="co">]</span>_i \sim N(\mu_i, \sigma^2)</span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a>\end{gather}</span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>We have three parameters, $\beta_0$, $\beta_1$, and $\beta_2$. We can determine the likelihood of the data given these parameters. Maximizing the likelihood is the <span class="co">[</span><span class="ot">most common way</span><span class="co">](https://online.stat.psu.edu/stat415/lesson/1/1.2)</span> to estimate the parameters from data. The idea is that we tune the parameters until we find the set of parameters that made the observed data most likely.</span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a>However, this won't quite work if we want to predict a binary outcome like species. We could form a model like this:</span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a>\begin{gather}</span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a>p_i = \beta_0 + \beta_1 <span class="co">[</span><span class="ot">\text{Bill Length}</span><span class="co">]</span>_i + \beta_2 [\text{Body Mass}]_i <span class="sc">\\</span></span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">\text{Species}</span><span class="co">]</span>_i \sim \operatorname{Bernoulli}(p_i)</span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a>\end{gather}</span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a>In words, each observation of a penguin is modeled as a Bernoulli random variable, where the probability of being Adelie is a linear function of bill length and body mass. The issue with this model is that if we let the parameters vary, the value of $p_i$ can exceed the range $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$, which doesn't make sense if we are trying to model a probability.</span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a>The solution is using the expit function:</span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a>\operatorname{expit} = \frac{e^{x}}{1+e^{x}}</span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a>This function takes in a real valued input and transforms it to lie within the range $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$. The expit function is also called the logistic function, hence the name "logistic regression".</span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>Let's try it out in an example.</span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a naive implementation that can overflow for large x</span></span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a><span class="co"># expit &lt;- function(x) exp(x) / (1 + exp(x))</span></span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Better to use the built-in version</span></span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>expit <span class="ot">&lt;-</span> plogis</span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the output of the expit() function for x values between -10 and 10</span></span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">length.out=</span><span class="fl">1e5</span>)</span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,</span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a>     <span class="fu">expit</span>(x),</span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Understanding the effect of expit"</span>)</span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>We see that (approximately) anything below -5 gets squashed to zero and anything above 5 gets squashed to 1.</span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a>We then modify our model to be</span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a>\begin{gather}</span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a>p_i = \operatorname{expit} \left(\beta_0 + \beta_1 <span class="co">[</span><span class="ot">\text{Bill Length}</span><span class="co">]</span> + \beta_2 <span class="co">[</span><span class="ot">\text{Body Mass}</span><span class="co">]</span> \right) <span class="sc">\\</span></span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a>\text{<span class="co">[</span><span class="ot">Species</span><span class="co">]</span>} \sim \operatorname{Bernoulli}(p_i)</span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a>\end{gather}</span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a>so now $p_i$ is constrained to lie within $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$. This type of model, where we take a linear function of the parameters and then apply a non-linear function to it, is known as a generalized linear model (GLM).</span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a>The likelihood contribution of a single observation is $p_i$ if it is Adelie and $1-p_i$ if it is Gentoo, which we can write as</span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a>\text{Likelihood}_i = p_i^{\text{Adelie}} (1-p_i)^{1 - \text{Adelie}}</span>
<span id="cb32-202"><a href="#cb32-202" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-203"><a href="#cb32-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-204"><a href="#cb32-204" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb32-205"><a href="#cb32-205" aria-hidden="true" tabindex="-1"></a>This form of writing the Bernoulli PMF works because if Adelie = 1, then $\text{Likelihood}_i = p_i^{1} (1-p_i)^{1 - 1} = p_i$ and if Adelie = 0, then $\text{Likelihood}_i = p_i^{0} (1-p_i)^{1 - 0} = 1-p_i$.</span>
<span id="cb32-206"><a href="#cb32-206" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-207"><a href="#cb32-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-208"><a href="#cb32-208" aria-hidden="true" tabindex="-1"></a>and therefore the log-likelihood contribution of a single observation is</span>
<span id="cb32-209"><a href="#cb32-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-210"><a href="#cb32-210" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-211"><a href="#cb32-211" aria-hidden="true" tabindex="-1"></a>\text{Log-Likelihood}_i = [\text{[Adelie]}_i \times \log(p_i)] + [(1 - \text{[Adelie]}_i) \times \log(1-p_i)]</span>
<span id="cb32-212"><a href="#cb32-212" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-213"><a href="#cb32-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-214"><a href="#cb32-214" aria-hidden="true" tabindex="-1"></a>The log-likelihood of the entire dataset is just the sum of all the individual log-likelihoods, since we are assuming independent observations, so we have</span>
<span id="cb32-215"><a href="#cb32-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-216"><a href="#cb32-216" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-217"><a href="#cb32-217" aria-hidden="true" tabindex="-1"></a>\text{Log-Likelihood} = \sum_{i=1}^{n} \left[ <span class="co">[</span><span class="ot">\text{[Adelie]}_i \times \log(p_i)</span><span class="co">]</span> + <span class="co">[</span><span class="ot">(1 - \text{[Adelie]}_i) \times \log(1-p_i)</span><span class="co">]</span> \right]</span>
<span id="cb32-218"><a href="#cb32-218" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb32-219"><a href="#cb32-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-220"><a href="#cb32-220" aria-hidden="true" tabindex="-1"></a>and now substituting in $p_i$ in terms of the parameters, we have</span>
<span id="cb32-221"><a href="#cb32-221" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb32-222"><a href="#cb32-222" aria-hidden="true" tabindex="-1"></a>\text{Log-Likelihood} &amp;= \underbrace{\sum_{i=1}^{n} [<span class="co">[</span><span class="ot">\text{[Adelie]}_i \times \log(\operatorname{expit} \left(\beta_0 + \beta_1 [\text{Bill Length}]_i + \beta_2 [\text{Body Mass}]_i \right))</span><span class="co">]</span>}_{\text{Contribution from Adelie observations}} \\ &amp;+ \underbrace{[(1 - \text{[Adelie]}_i) \times \log(1-\operatorname{expit} \left(\beta_0 + \beta_1 [\text{Bill Length}]_i + \beta_2 [\text{Body Mass}]_i \right))]}_{\text{Contribution from Gentoo observations}}]</span>
<span id="cb32-223"><a href="#cb32-223" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb32-224"><a href="#cb32-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-225"><a href="#cb32-225" aria-hidden="true" tabindex="-1"></a>We can then pick $\beta_0$, $\beta_1$, and $\beta_2$ to maximize this log-likelihood function, or as is often done in practice, minimize the negative log-likelihood function. We will need to do this with numerical methods, rather than obtaining an analytical solution with calculus, since no closed-form solution exists.</span>
<span id="cb32-226"><a href="#cb32-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-227"><a href="#cb32-227" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression with `glm()`</span></span>
<span id="cb32-228"><a href="#cb32-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-229"><a href="#cb32-229" aria-hidden="true" tabindex="-1"></a>Before we implement logistic regression by hand, we will use the <span class="in">`glm()`</span> function in R as a baseline. Under the hood, R uses the <span class="co">[</span><span class="ot">Fisher Scoring Algorithm</span><span class="co">](https://en.wikipedia.org/wiki/Scoring_algorithm)</span> to obtain the maximum likelihood estimates.</span>
<span id="cb32-230"><a href="#cb32-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-233"><a href="#cb32-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-234"><a href="#cb32-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the logistic regression model</span></span>
<span id="cb32-235"><a href="#cb32-235" aria-hidden="true" tabindex="-1"></a>model_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(adelie <span class="sc">~</span> bill_length_cm <span class="sc">+</span> body_mass_kg,</span>
<span id="cb32-236"><a href="#cb32-236" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb32-237"><a href="#cb32-237" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>df)</span>
<span id="cb32-238"><a href="#cb32-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-239"><a href="#cb32-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-240"><a href="#cb32-240" aria-hidden="true" tabindex="-1"></a>Now that we have fit the model, let's look at the predictions of the model. We can make a grid of covariate values, and ask the model to give us the predicted probability of Species = Adelie for each one.</span>
<span id="cb32-241"><a href="#cb32-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-244"><a href="#cb32-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-245"><a href="#cb32-245" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of values on which to evaluate probabilities</span></span>
<span id="cb32-246"><a href="#cb32-246" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span></span>
<span id="cb32-247"><a href="#cb32-247" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">bill_length_cm =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df<span class="sc">$</span>bill_length_cm)<span class="sc">-</span><span class="fl">0.2</span>, <span class="fu">max</span>(df<span class="sc">$</span>bill_length_cm)<span class="sc">+</span><span class="fl">0.2</span>, <span class="fl">0.001</span>),</span>
<span id="cb32-248"><a href="#cb32-248" aria-hidden="true" tabindex="-1"></a>         <span class="at">body_mass_kg =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df<span class="sc">$</span>body_mass_kg)<span class="sc">-</span><span class="fl">0.1</span>, <span class="fu">max</span>(df<span class="sc">$</span>body_mass_kg)<span class="sc">+</span><span class="fl">0.1</span>, <span class="fl">0.005</span>))</span>
<span id="cb32-249"><a href="#cb32-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-250"><a href="#cb32-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-251"><a href="#cb32-251" aria-hidden="true" tabindex="-1"></a>We use the <span class="in">`predict()`</span> function to obtain the predicted probabilities. Using <span class="in">`type = "response"`</span> specifies that we want the predictions on the probability scale (i.e., after passing the linear predictor through the <span class="in">`expit`</span> function.).</span>
<span id="cb32-252"><a href="#cb32-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-255"><a href="#cb32-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-256"><a href="#cb32-256" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_glm, grid, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb32-257"><a href="#cb32-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-258"><a href="#cb32-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-261"><a href="#cb32-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-262"><a href="#cb32-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-263"><a href="#cb32-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-264"><a href="#cb32-264" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb32-265"><a href="#cb32-265" aria-hidden="true" tabindex="-1"></a>grid <span class="sc">%&gt;%</span></span>
<span id="cb32-266"><a href="#cb32-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-267"><a href="#cb32-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-268"><a href="#cb32-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-269"><a href="#cb32-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"300px"</span>)</span>
<span id="cb32-270"><a href="#cb32-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-271"><a href="#cb32-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-272"><a href="#cb32-272" aria-hidden="true" tabindex="-1"></a>Now that we have the predictions, let's plot them and overlay the data with their true labels. The model looks to be performing pretty well!</span>
<span id="cb32-273"><a href="#cb32-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-276"><a href="#cb32-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-277"><a href="#cb32-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-278"><a href="#cb32-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb32-279"><a href="#cb32-279" aria-hidden="true" tabindex="-1"></a>grid <span class="sc">%&gt;%</span></span>
<span id="cb32-280"><a href="#cb32-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-281"><a href="#cb32-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>bill_length_cm,</span>
<span id="cb32-282"><a href="#cb32-282" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>body_mass_kg) <span class="sc">+</span></span>
<span id="cb32-283"><a href="#cb32-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>predicted)) <span class="sc">+</span></span>
<span id="cb32-284"><a href="#cb32-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color=</span>species)) <span class="sc">+</span></span>
<span id="cb32-285"><a href="#cb32-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>df, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">shape=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb32-286"><a href="#cb32-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>),</span>
<span id="cb32-287"><a href="#cb32-287" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb32-288"><a href="#cb32-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb32-289"><a href="#cb32-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb32-290"><a href="#cb32-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb32-291"><a href="#cb32-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Probability of Adelie</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb32-292"><a href="#cb32-292" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb32-293"><a href="#cb32-293" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Bill length (mm)"</span>,</span>
<span id="cb32-294"><a href="#cb32-294" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Body mass (g)"</span>,</span>
<span id="cb32-295"><a href="#cb32-295" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Visualizing the predictions of the logistic regression model"</span>) <span class="sc">+</span></span>
<span id="cb32-296"><a href="#cb32-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))</span>
<span id="cb32-297"><a href="#cb32-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-298"><a href="#cb32-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-299"><a href="#cb32-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-300"><a href="#cb32-300" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression with `optim()`</span></span>
<span id="cb32-301"><a href="#cb32-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-302"><a href="#cb32-302" aria-hidden="true" tabindex="-1"></a>Now that we know what to expect after using <span class="in">`glm()`</span>, let's implement logistic regression by hand.</span>
<span id="cb32-303"><a href="#cb32-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-304"><a href="#cb32-304" aria-hidden="true" tabindex="-1"></a>Recall that we would like to numerically determine the beta values that minimize the negative log-likelihood. The <span class="in">`optim()`</span> function in R is a general-purpose function for minimizing functions^<span class="co">[</span><span class="ot">This [short video](https://youtu.be/Qvye1wDa0kk) is a good introduction to `optim()`.</span><span class="co">]</span>.</span>
<span id="cb32-305"><a href="#cb32-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-306"><a href="#cb32-306" aria-hidden="true" tabindex="-1"></a><span class="in">`optim()`</span> has an algorithm called <span class="co">[</span><span class="ot">Nelder-Mead</span><span class="co">](https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method)</span> that searches the parameter space and converges on the minimum value. It is a direct search method that only requires the negative log-likelihood function as input (as opposed to gradient based methods that require specified the gradients of the negative log-likelihood function). This animation demonstrates the Nelder-Mead algorithm in action^<span class="co">[</span><span class="ot">Sourced from [here](https://commons.wikimedia.org/wiki/File:Nelder-Mead_Rosenbrock.gif)</span><span class="co">]</span>.</span>
<span id="cb32-307"><a href="#cb32-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-308"><a href="#cb32-308" aria-hidden="true" tabindex="-1"></a><span class="al">![Nelder-Mead animation](nelder_mead.mp4)</span></span>
<span id="cb32-309"><a href="#cb32-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-310"><a href="#cb32-310" aria-hidden="true" tabindex="-1"></a>To use <span class="in">`optim()`</span>, we create a function that takes as input the parameters and returns the negative log-likelihood. The below code is a translation of the mathematical notation from above.</span>
<span id="cb32-311"><a href="#cb32-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-314"><a href="#cb32-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-315"><a href="#cb32-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-316"><a href="#cb32-316" aria-hidden="true" tabindex="-1"></a>neg_loglikelihood_function <span class="ot">&lt;-</span> <span class="cf">function</span>(parameters){</span>
<span id="cb32-317"><a href="#cb32-317" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-318"><a href="#cb32-318" aria-hidden="true" tabindex="-1"></a>  <span class="co"># optim() expects the parameters as a single vector, so we set the coefficients</span></span>
<span id="cb32-319"><a href="#cb32-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as the elements of a vector called `parameters`</span></span>
<span id="cb32-320"><a href="#cb32-320" aria-hidden="true" tabindex="-1"></a>  b0 <span class="ot">&lt;-</span> parameters[<span class="dv">1</span>]</span>
<span id="cb32-321"><a href="#cb32-321" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> parameters[<span class="dv">2</span>]</span>
<span id="cb32-322"><a href="#cb32-322" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> parameters[<span class="dv">3</span>]</span>
<span id="cb32-323"><a href="#cb32-323" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-324"><a href="#cb32-324" aria-hidden="true" tabindex="-1"></a>  linear_predictor <span class="ot">&lt;-</span> (b0) <span class="sc">+</span> (b1<span class="sc">*</span>df<span class="sc">$</span>bill_length_cm) <span class="sc">+</span> (b2<span class="sc">*</span>df<span class="sc">$</span>body_mass_kg)</span>
<span id="cb32-325"><a href="#cb32-325" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-326"><a href="#cb32-326" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Likelihood for each observation</span></span>
<span id="cb32-327"><a href="#cb32-327" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the observation is Adelie, then the likelihood is the probability of Adelie</span></span>
<span id="cb32-328"><a href="#cb32-328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the observation is not Adelie (i.e., Gentoo), then the likelihood is the probability of not Adelie</span></span>
<span id="cb32-329"><a href="#cb32-329" aria-hidden="true" tabindex="-1"></a>  <span class="co"># which is 1 - P(Adelie)</span></span>
<span id="cb32-330"><a href="#cb32-330" aria-hidden="true" tabindex="-1"></a>  likelihood <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>adelie<span class="sc">==</span><span class="dv">1</span>,</span>
<span id="cb32-331"><a href="#cb32-331" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">expit</span>(linear_predictor),</span>
<span id="cb32-332"><a href="#cb32-332" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span><span class="sc">-</span><span class="fu">expit</span>(linear_predictor))</span>
<span id="cb32-333"><a href="#cb32-333" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-334"><a href="#cb32-334" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Log-likelihood for each observation</span></span>
<span id="cb32-335"><a href="#cb32-335" aria-hidden="true" tabindex="-1"></a>  log_likelihood <span class="ot">&lt;-</span> <span class="fu">log</span>(likelihood)</span>
<span id="cb32-336"><a href="#cb32-336" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-337"><a href="#cb32-337" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Joint log-likelihood for all the observations. Note the sum because</span></span>
<span id="cb32-338"><a href="#cb32-338" aria-hidden="true" tabindex="-1"></a>  <span class="co"># multiplication is addition on the log-scale</span></span>
<span id="cb32-339"><a href="#cb32-339" aria-hidden="true" tabindex="-1"></a>  total_log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(log_likelihood)</span>
<span id="cb32-340"><a href="#cb32-340" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-341"><a href="#cb32-341" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the optim() function only minimizes, so we return the negative log-likelihood</span></span>
<span id="cb32-342"><a href="#cb32-342" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and then maximize it</span></span>
<span id="cb32-343"><a href="#cb32-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>total_log_likelihood)</span>
<span id="cb32-344"><a href="#cb32-344" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-345"><a href="#cb32-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-346"><a href="#cb32-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-347"><a href="#cb32-347" aria-hidden="true" tabindex="-1"></a>As an example, we can pass in $\beta_0 = 1, \beta_1 = 2, \beta_2 = 3$ and see what the negative log-likelihood is.</span>
<span id="cb32-348"><a href="#cb32-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-351"><a href="#cb32-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-352"><a href="#cb32-352" aria-hidden="true" tabindex="-1"></a><span class="fu">neg_loglikelihood_function</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb32-353"><a href="#cb32-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-354"><a href="#cb32-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-355"><a href="#cb32-355" aria-hidden="true" tabindex="-1"></a>Because the negative log-likelihood is very high, we know that these are poor choices for the parameter values.</span>
<span id="cb32-356"><a href="#cb32-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-357"><a href="#cb32-357" aria-hidden="true" tabindex="-1"></a>We can visualize the negative log-likelihood function for a variety of values. Since there are 3 parameters in our model, and we cannot visualize in 4D, we set $\beta_0 = 58.075$, which was the optimized value found by <span class="in">`glm()`</span> and we can visualize how the negative log-likelihood varies with $\beta_1$ and $\beta_2$.</span>
<span id="cb32-358"><a href="#cb32-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-361"><a href="#cb32-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-362"><a href="#cb32-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of parameter values</span></span>
<span id="cb32-363"><a href="#cb32-363" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span></span>
<span id="cb32-364"><a href="#cb32-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(</span>
<span id="cb32-365"><a href="#cb32-365" aria-hidden="true" tabindex="-1"></a>    <span class="at">b0 =</span> <span class="fl">58.075</span>,</span>
<span id="cb32-366"><a href="#cb32-366" aria-hidden="true" tabindex="-1"></a>    <span class="at">b1 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="at">length.out=</span><span class="fl">1e2</span>),</span>
<span id="cb32-367"><a href="#cb32-367" aria-hidden="true" tabindex="-1"></a>    <span class="at">b2 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length.out=</span><span class="fl">1e2</span>)</span>
<span id="cb32-368"><a href="#cb32-368" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-369"><a href="#cb32-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-370"><a href="#cb32-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-373"><a href="#cb32-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-374"><a href="#cb32-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the negative log-likelihood for each parameter value</span></span>
<span id="cb32-375"><a href="#cb32-375" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>neg_loglikelihood <span class="ot">&lt;-</span></span>
<span id="cb32-376"><a href="#cb32-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_dbl</span>(grid,</span>
<span id="cb32-377"><a href="#cb32-377" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span><span class="fu">neg_loglikelihood_function</span>(<span class="fu">c</span>(..<span class="dv">1</span>, ..<span class="dv">2</span>, ..<span class="dv">3</span>)))</span>
<span id="cb32-378"><a href="#cb32-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-379"><a href="#cb32-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-382"><a href="#cb32-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-383"><a href="#cb32-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-384"><a href="#cb32-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb32-385"><a href="#cb32-385" aria-hidden="true" tabindex="-1"></a><span class="co"># Show a heatmap of the negative log-likelihood with contour lines</span></span>
<span id="cb32-386"><a href="#cb32-386" aria-hidden="true" tabindex="-1"></a>grid <span class="sc">%&gt;%</span></span>
<span id="cb32-387"><a href="#cb32-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-388"><a href="#cb32-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>b1,</span>
<span id="cb32-389"><a href="#cb32-389" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>b2) <span class="sc">+</span></span>
<span id="cb32-390"><a href="#cb32-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>neg_loglikelihood)) <span class="sc">+</span></span>
<span id="cb32-391"><a href="#cb32-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z=</span>neg_loglikelihood), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb32-392"><a href="#cb32-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb32-393"><a href="#cb32-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb32-394"><a href="#cb32-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">"point"</span>, <span class="at">x=</span><span class="sc">-</span><span class="fl">8.999</span>, <span class="at">y=</span><span class="sc">-</span><span class="fl">4.363</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb32-395"><a href="#cb32-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Negative log-likelihood</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb32-396"><a href="#cb32-396" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Beta 1"</span>,</span>
<span id="cb32-397"><a href="#cb32-397" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Beta 2"</span>,</span>
<span id="cb32-398"><a href="#cb32-398" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Visualizing the negative log-likelihood function"</span>) <span class="sc">+</span></span>
<span id="cb32-399"><a href="#cb32-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))</span>
<span id="cb32-400"><a href="#cb32-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-401"><a href="#cb32-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-402"><a href="#cb32-402" aria-hidden="true" tabindex="-1"></a>To use <span class="in">`optim()`</span>, we pass in the starting parameter values to <span class="in">`par`</span> and the function to be minimized (the negative log-likelihood) to <span class="in">`fn`</span>. Finally, we'll specify <span class="in">`method="Nelder-Mead"`</span>.</span>
<span id="cb32-403"><a href="#cb32-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-406"><a href="#cb32-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-407"><a href="#cb32-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-408"><a href="#cb32-408" aria-hidden="true" tabindex="-1"></a>optim_results <span class="ot">&lt;-</span></span>
<span id="cb32-409"><a href="#cb32-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),                      <span class="co"># Initial values</span></span>
<span id="cb32-410"><a href="#cb32-410" aria-hidden="true" tabindex="-1"></a>        <span class="at">fn =</span> neg_loglikelihood_function,   <span class="co"># Objective function to be minimized</span></span>
<span id="cb32-411"><a href="#cb32-411" aria-hidden="true" tabindex="-1"></a>        <span class="at">method=</span><span class="st">"Nelder-Mead"</span>)              <span class="co"># Optimization method</span></span>
<span id="cb32-412"><a href="#cb32-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-413"><a href="#cb32-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-414"><a href="#cb32-414" aria-hidden="true" tabindex="-1"></a>The maximum likelihood estimates are stored in the <span class="in">`$par`</span> attribute of the <span class="in">`optim`</span> object</span>
<span id="cb32-415"><a href="#cb32-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-418"><a href="#cb32-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-419"><a href="#cb32-419" aria-hidden="true" tabindex="-1"></a>optim_results<span class="sc">$</span>par</span>
<span id="cb32-420"><a href="#cb32-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-421"><a href="#cb32-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-422"><a href="#cb32-422" aria-hidden="true" tabindex="-1"></a>which we can compare with the coefficients obtained from <span class="in">`glm()`</span>, and we see that they match quite closely.</span>
<span id="cb32-423"><a href="#cb32-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-426"><a href="#cb32-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-427"><a href="#cb32-427" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model_glm)</span>
<span id="cb32-428"><a href="#cb32-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-429"><a href="#cb32-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-430"><a href="#cb32-430" aria-hidden="true" tabindex="-1"></a>The below animation demonstrates the path of the Nelder-Mead function^<span class="co">[</span><span class="ot">The code for this animation is long, so it is not included here, but can be viewed in the source code of the Quarto document.</span><span class="co">]</span>. As stated above, for the purpose of the animation, we set the optimized value of $\beta_0 = 58.075$ and we can visualize how the negative log-likelihood is optimized with respect to $\beta_1$ and $\beta_2$.</span>
<span id="cb32-431"><a href="#cb32-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-434"><a href="#cb32-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-435"><a href="#cb32-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-436"><a href="#cb32-436" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"nelder_mead_path.mp4"</span>)) {</span>
<span id="cb32-437"><a href="#cb32-437" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-438"><a href="#cb32-438" aria-hidden="true" tabindex="-1"></a>  neg_loglikelihood_function <span class="ot">&lt;-</span> <span class="cf">function</span>(parameters){</span>
<span id="cb32-439"><a href="#cb32-439" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-440"><a href="#cb32-440" aria-hidden="true" tabindex="-1"></a>    <span class="co"># optim() expects the parameters as a single vector, so we set the coefficients</span></span>
<span id="cb32-441"><a href="#cb32-441" aria-hidden="true" tabindex="-1"></a>    <span class="co"># as the elements of a vector called `parameters`</span></span>
<span id="cb32-442"><a href="#cb32-442" aria-hidden="true" tabindex="-1"></a>    b0 <span class="ot">&lt;-</span> <span class="fl">58.075</span></span>
<span id="cb32-443"><a href="#cb32-443" aria-hidden="true" tabindex="-1"></a>    b1 <span class="ot">&lt;-</span> parameters[<span class="dv">1</span>]</span>
<span id="cb32-444"><a href="#cb32-444" aria-hidden="true" tabindex="-1"></a>    b2 <span class="ot">&lt;-</span> parameters[<span class="dv">2</span>]</span>
<span id="cb32-445"><a href="#cb32-445" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-446"><a href="#cb32-446" aria-hidden="true" tabindex="-1"></a>    linear_predictor <span class="ot">&lt;-</span> (b0) <span class="sc">+</span> (b1<span class="sc">*</span>df<span class="sc">$</span>bill_length_cm) <span class="sc">+</span> (b2<span class="sc">*</span>df<span class="sc">$</span>body_mass_kg)</span>
<span id="cb32-447"><a href="#cb32-447" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-448"><a href="#cb32-448" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Likelihood for each observation</span></span>
<span id="cb32-449"><a href="#cb32-449" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the observation is Adelie, then the likelihood is the probability of Adelie</span></span>
<span id="cb32-450"><a href="#cb32-450" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the observation is not Adelie (i.e., Gentoo), then the likelihood is the probability of not Adelie</span></span>
<span id="cb32-451"><a href="#cb32-451" aria-hidden="true" tabindex="-1"></a>    <span class="co"># which is 1 - P(Adelie)</span></span>
<span id="cb32-452"><a href="#cb32-452" aria-hidden="true" tabindex="-1"></a>    likelihood <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>adelie<span class="sc">==</span><span class="dv">1</span>,</span>
<span id="cb32-453"><a href="#cb32-453" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">expit</span>(linear_predictor),</span>
<span id="cb32-454"><a href="#cb32-454" aria-hidden="true" tabindex="-1"></a>                         <span class="dv">1</span><span class="sc">-</span><span class="fu">expit</span>(linear_predictor))</span>
<span id="cb32-455"><a href="#cb32-455" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-456"><a href="#cb32-456" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log-likelihood for each observation</span></span>
<span id="cb32-457"><a href="#cb32-457" aria-hidden="true" tabindex="-1"></a>    log_likelihood <span class="ot">&lt;-</span> <span class="fu">log</span>(likelihood)</span>
<span id="cb32-458"><a href="#cb32-458" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-459"><a href="#cb32-459" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Joint log-likelihood for all the observations. Note the sum because</span></span>
<span id="cb32-460"><a href="#cb32-460" aria-hidden="true" tabindex="-1"></a>    <span class="co"># multiplication is addition on the log-scale</span></span>
<span id="cb32-461"><a href="#cb32-461" aria-hidden="true" tabindex="-1"></a>    total_log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(log_likelihood)</span>
<span id="cb32-462"><a href="#cb32-462" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-463"><a href="#cb32-463" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the optim() function only minimizes, so we return the negative log-likelihood</span></span>
<span id="cb32-464"><a href="#cb32-464" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and then maximize it</span></span>
<span id="cb32-465"><a href="#cb32-465" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span>total_log_likelihood)</span>
<span id="cb32-466"><a href="#cb32-466" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-467"><a href="#cb32-467" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-468"><a href="#cb32-468" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Optimizing</span></span>
<span id="cb32-469"><a href="#cb32-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb32-470"><a href="#cb32-470" aria-hidden="true" tabindex="-1"></a>  optim_res <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>),</span>
<span id="cb32-471"><a href="#cb32-471" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fn =</span> neg_loglikelihood_function,</span>
<span id="cb32-472"><a href="#cb32-472" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method=</span><span class="st">"Nelder-Mead"</span>)</span>
<span id="cb32-473"><a href="#cb32-473" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-474"><a href="#cb32-474" aria-hidden="true" tabindex="-1"></a>  run_opt <span class="ot">&lt;-</span> <span class="cf">function</span>(maxit){</span>
<span id="cb32-475"><a href="#cb32-475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb32-476"><a href="#cb32-476" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span></span>
<span id="cb32-477"><a href="#cb32-477" aria-hidden="true" tabindex="-1"></a>      <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>),</span>
<span id="cb32-478"><a href="#cb32-478" aria-hidden="true" tabindex="-1"></a>            <span class="at">fn =</span> neg_loglikelihood_function,</span>
<span id="cb32-479"><a href="#cb32-479" aria-hidden="true" tabindex="-1"></a>            <span class="at">method=</span><span class="st">"Nelder-Mead"</span>,</span>
<span id="cb32-480"><a href="#cb32-480" aria-hidden="true" tabindex="-1"></a>            <span class="at">control=</span><span class="fu">list</span>(<span class="at">maxit=</span>maxit))</span>
<span id="cb32-481"><a href="#cb32-481" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-482"><a href="#cb32-482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">tibble</span>(<span class="at">b1=</span>res<span class="sc">$</span>par[<span class="dv">1</span>],</span>
<span id="cb32-483"><a href="#cb32-483" aria-hidden="true" tabindex="-1"></a>                  <span class="at">b2=</span>res<span class="sc">$</span>par[<span class="dv">2</span>],</span>
<span id="cb32-484"><a href="#cb32-484" aria-hidden="true" tabindex="-1"></a>                  <span class="at">val=</span>res<span class="sc">$</span>value))</span>
<span id="cb32-485"><a href="#cb32-485" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-486"><a href="#cb32-486" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-487"><a href="#cb32-487" aria-hidden="true" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> optim_res<span class="sc">$</span>counts[<span class="st">"function"</span>]</span>
<span id="cb32-488"><a href="#cb32-488" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-489"><a href="#cb32-489" aria-hidden="true" tabindex="-1"></a>  path_df <span class="ot">&lt;-</span></span>
<span id="cb32-490"><a href="#cb32-490" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>counts, <span class="sc">~</span><span class="fu">run_opt</span>(.x)) <span class="sc">%&gt;%</span></span>
<span id="cb32-491"><a href="#cb32-491" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">step =</span> <span class="dv">1</span><span class="sc">:</span>counts)</span>
<span id="cb32-492"><a href="#cb32-492" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-493"><a href="#cb32-493" aria-hidden="true" tabindex="-1"></a>  grid <span class="ot">&lt;-</span></span>
<span id="cb32-494"><a href="#cb32-494" aria-hidden="true" tabindex="-1"></a>    <span class="fu">crossing</span>(</span>
<span id="cb32-495"><a href="#cb32-495" aria-hidden="true" tabindex="-1"></a>      <span class="at">b1 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="at">length.out=</span><span class="fl">1e3</span>),</span>
<span id="cb32-496"><a href="#cb32-496" aria-hidden="true" tabindex="-1"></a>      <span class="at">b2 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="at">length.out=</span><span class="fl">1e3</span>)</span>
<span id="cb32-497"><a href="#cb32-497" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-498"><a href="#cb32-498" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-499"><a href="#cb32-499" aria-hidden="true" tabindex="-1"></a>  grid<span class="sc">$</span>neg_loglikelihood <span class="ot">&lt;-</span></span>
<span id="cb32-500"><a href="#cb32-500" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pmap_dbl</span>(grid,</span>
<span id="cb32-501"><a href="#cb32-501" aria-hidden="true" tabindex="-1"></a>             <span class="sc">~</span><span class="fu">neg_loglikelihood_function</span>(<span class="fu">c</span>(..<span class="dv">1</span>, ..<span class="dv">2</span>)))</span>
<span id="cb32-502"><a href="#cb32-502" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-503"><a href="#cb32-503" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span></span>
<span id="cb32-504"><a href="#cb32-504" aria-hidden="true" tabindex="-1"></a>    path_df <span class="sc">%&gt;%</span></span>
<span id="cb32-505"><a href="#cb32-505" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-506"><a href="#cb32-506" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>b1, <span class="at">y=</span>b2) <span class="sc">+</span></span>
<span id="cb32-507"><a href="#cb32-507" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="at">data=</span>grid, <span class="fu">aes</span>(<span class="at">fill =</span> neg_loglikelihood)) <span class="sc">+</span></span>
<span id="cb32-508"><a href="#cb32-508" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour</span>(<span class="at">data =</span> grid, <span class="fu">aes</span>(<span class="at">z=</span>neg_loglikelihood), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb32-509"><a href="#cb32-509" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb32-510"><a href="#cb32-510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb32-511"><a href="#cb32-511" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb32-512"><a href="#cb32-512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb32-513"><a href="#cb32-513" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="at">geom=</span><span class="st">"point"</span>, <span class="at">x=</span><span class="sc">-</span><span class="fl">8.999</span>, <span class="at">y=</span><span class="sc">-</span><span class="fl">4.363</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb32-514"><a href="#cb32-514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transition_reveal</span>(<span class="at">along =</span> step) <span class="sc">+</span></span>
<span id="cb32-515"><a href="#cb32-515" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Iteration: {frame_along}"</span>,</span>
<span id="cb32-516"><a href="#cb32-516" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Negative log-likelihood</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb32-517"><a href="#cb32-517" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Beta 1"</span>,</span>
<span id="cb32-518"><a href="#cb32-518" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Beta 2"</span>,</span>
<span id="cb32-519"><a href="#cb32-519" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Visualizing the path of Nelder-Mead"</span>) <span class="sc">+</span></span>
<span id="cb32-520"><a href="#cb32-520" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb32-521"><a href="#cb32-521" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))</span>
<span id="cb32-522"><a href="#cb32-522" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-523"><a href="#cb32-523" aria-hidden="true" tabindex="-1"></a>  gif <span class="ot">&lt;-</span> <span class="fu">animate</span>(p1,</span>
<span id="cb32-524"><a href="#cb32-524" aria-hidden="true" tabindex="-1"></a>                 <span class="at">duration=</span><span class="dv">10</span>,</span>
<span id="cb32-525"><a href="#cb32-525" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb32-526"><a href="#cb32-526" aria-hidden="true" tabindex="-1"></a>                 <span class="at">width =</span> <span class="dv">5</span>,</span>
<span id="cb32-527"><a href="#cb32-527" aria-hidden="true" tabindex="-1"></a>                 <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb32-528"><a href="#cb32-528" aria-hidden="true" tabindex="-1"></a>                 <span class="at">res =</span> <span class="dv">300</span>,</span>
<span id="cb32-529"><a href="#cb32-529" aria-hidden="true" tabindex="-1"></a>                 <span class="at">renderer =</span> <span class="fu">ffmpeg_renderer</span>())</span>
<span id="cb32-530"><a href="#cb32-530" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-531"><a href="#cb32-531" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save to mp4</span></span>
<span id="cb32-532"><a href="#cb32-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anim_save</span>(<span class="at">animation =</span> gif, <span class="at">filename =</span> <span class="st">"p1.mp4"</span>)</span>
<span id="cb32-533"><a href="#cb32-533" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-534"><a href="#cb32-534" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span></span>
<span id="cb32-535"><a href="#cb32-535" aria-hidden="true" tabindex="-1"></a>    path_df <span class="sc">%&gt;%</span></span>
<span id="cb32-536"><a href="#cb32-536" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-537"><a href="#cb32-537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>step, <span class="at">y=</span>val) <span class="sc">+</span></span>
<span id="cb32-538"><a href="#cb32-538" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-539"><a href="#cb32-539" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb32-540"><a href="#cb32-540" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transition_reveal</span>(<span class="at">along =</span> step) <span class="sc">+</span></span>
<span id="cb32-541"><a href="#cb32-541" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb32-542"><a href="#cb32-542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Objective function"</span>,</span>
<span id="cb32-543"><a href="#cb32-543" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">"Iteration"</span>,</span>
<span id="cb32-544"><a href="#cb32-544" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">'Negative Log-Likelihood'</span>) <span class="sc">+</span></span>
<span id="cb32-545"><a href="#cb32-545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb32-546"><a href="#cb32-546" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-547"><a href="#cb32-547" aria-hidden="true" tabindex="-1"></a>  gif <span class="ot">&lt;-</span> <span class="fu">animate</span>(p2,</span>
<span id="cb32-548"><a href="#cb32-548" aria-hidden="true" tabindex="-1"></a>                 <span class="at">duration=</span><span class="dv">10</span>,</span>
<span id="cb32-549"><a href="#cb32-549" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb32-550"><a href="#cb32-550" aria-hidden="true" tabindex="-1"></a>                 <span class="at">width =</span> <span class="dv">3</span>,</span>
<span id="cb32-551"><a href="#cb32-551" aria-hidden="true" tabindex="-1"></a>                 <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb32-552"><a href="#cb32-552" aria-hidden="true" tabindex="-1"></a>                 <span class="at">res =</span> <span class="dv">300</span>,</span>
<span id="cb32-553"><a href="#cb32-553" aria-hidden="true" tabindex="-1"></a>                 <span class="at">renderer =</span> <span class="fu">ffmpeg_renderer</span>())</span>
<span id="cb32-554"><a href="#cb32-554" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-555"><a href="#cb32-555" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save to mp4</span></span>
<span id="cb32-556"><a href="#cb32-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anim_save</span>(<span class="at">animation =</span> gif, <span class="at">filename =</span> <span class="st">"p2.mp4"</span>)</span>
<span id="cb32-557"><a href="#cb32-557" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-558"><a href="#cb32-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system</span>(<span class="st">'ffmpeg -i p1.mp4 -i p2.mp4 -filter_complex hstack nelder_mead_path.mp4 -vsync 2'</span>)</span>
<span id="cb32-559"><a href="#cb32-559" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-560"><a href="#cb32-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-561"><a href="#cb32-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-562"><a href="#cb32-562" aria-hidden="true" tabindex="-1"></a>::: {.column-page-right}</span>
<span id="cb32-563"><a href="#cb32-563" aria-hidden="true" tabindex="-1"></a><span class="al">![Animation of the path taken by the Nelder Mead algorithm](nelder_mead_path.mp4)</span></span>
<span id="cb32-564"><a href="#cb32-564" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-565"><a href="#cb32-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-566"><a href="#cb32-566" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression with gradient descent</span></span>
<span id="cb32-567"><a href="#cb32-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-568"><a href="#cb32-568" aria-hidden="true" tabindex="-1"></a>Going one step further, instead of using a built-in optimization algorithm, let's maximize the likelihood ourselves using gradient descent. If you need a refresher, I have written a blog post on gradient descent which you can find <span class="co">[</span><span class="ot">here</span><span class="co">](https://maximilianrohde.com/posts/gradient-descent-pt1/)</span>.</span>
<span id="cb32-569"><a href="#cb32-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-570"><a href="#cb32-570" aria-hidden="true" tabindex="-1"></a>We need the gradient of the negative-log likelihood function. The slope with respect to the jth parameter is given by</span>
<span id="cb32-571"><a href="#cb32-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-572"><a href="#cb32-572" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb32-573"><a href="#cb32-573" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">\operatorname{expit}(\mathbf{\beta} \cdot \mathbf{x})-\mathbf{y}</span><span class="co">]</span> \mathbf{x}_{j} \implies [\hat{\mathbf{y}}-\mathbf{y}] \mathbf{x}_{j}</span>
<span id="cb32-574"><a href="#cb32-574" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb32-575"><a href="#cb32-575" aria-hidden="true" tabindex="-1"></a>so then the gradient can be written as</span>
<span id="cb32-576"><a href="#cb32-576" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb32-577"><a href="#cb32-577" aria-hidden="true" tabindex="-1"></a>\mathbf{X}^T <span class="co">[</span><span class="ot">\operatorname{expit}(\mathbf{X} \mathbf{\beta}) - \mathbf{y}</span><span class="co">]</span></span>
<span id="cb32-578"><a href="#cb32-578" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb32-579"><a href="#cb32-579" aria-hidden="true" tabindex="-1"></a>or equivalently</span>
<span id="cb32-580"><a href="#cb32-580" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb32-581"><a href="#cb32-581" aria-hidden="true" tabindex="-1"></a>\mathbf{X}^T (\hat{\mathbf{y}} - \mathbf{y})</span>
<span id="cb32-582"><a href="#cb32-582" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb32-583"><a href="#cb32-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-584"><a href="#cb32-584" aria-hidden="true" tabindex="-1"></a>You can find a nice derivation of the derivative of the negative log-likelihood for logistic regression <span class="co">[</span><span class="ot">here</span><span class="co">](https://web.stanford.edu/~jurafsky/slp3/5.pdf)</span>.</span>
<span id="cb32-585"><a href="#cb32-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-586"><a href="#cb32-586" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb32-587"><a href="#cb32-587" aria-hidden="true" tabindex="-1"></a>Another approach is to use automatic differentiation. Automatic differentiation can be used to obtain gradients for arbitrary functions, and is used heavily in deep learning. An example to do this in R using the <span class="in">`torch`</span> library is shown <span class="co">[</span><span class="ot">here</span><span class="co">](https://rgiordan.github.io/code/2022/04/01/rtorch_example.html)</span>.</span>
<span id="cb32-588"><a href="#cb32-588" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-589"><a href="#cb32-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-590"><a href="#cb32-590" aria-hidden="true" tabindex="-1"></a>We implement the above equations in the following function for the gradient.</span>
<span id="cb32-591"><a href="#cb32-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-594"><a href="#cb32-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-595"><a href="#cb32-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-596"><a href="#cb32-596" aria-hidden="true" tabindex="-1"></a>gradient <span class="ot">&lt;-</span> <span class="cf">function</span>(parameters){</span>
<span id="cb32-597"><a href="#cb32-597" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Given a vector of parameters values, return the current gradient</span></span>
<span id="cb32-598"><a href="#cb32-598" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-599"><a href="#cb32-599" aria-hidden="true" tabindex="-1"></a>  b0 <span class="ot">&lt;-</span> parameters[<span class="dv">1</span>]</span>
<span id="cb32-600"><a href="#cb32-600" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> parameters[<span class="dv">2</span>]</span>
<span id="cb32-601"><a href="#cb32-601" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> parameters[<span class="dv">3</span>]</span>
<span id="cb32-602"><a href="#cb32-602" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-603"><a href="#cb32-603" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define design matrix</span></span>
<span id="cb32-604"><a href="#cb32-604" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df)),</span>
<span id="cb32-605"><a href="#cb32-605" aria-hidden="true" tabindex="-1"></a>                 df<span class="sc">$</span>bill_length_cm,</span>
<span id="cb32-606"><a href="#cb32-606" aria-hidden="true" tabindex="-1"></a>                 df<span class="sc">$</span>body_mass_kg)</span>
<span id="cb32-607"><a href="#cb32-607" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-608"><a href="#cb32-608" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(parameters)</span>
<span id="cb32-609"><a href="#cb32-609" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-610"><a href="#cb32-610" aria-hidden="true" tabindex="-1"></a>  y_hat <span class="ot">&lt;-</span> <span class="fu">expit</span>(X <span class="sc">%*%</span> beta)</span>
<span id="cb32-611"><a href="#cb32-611" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-612"><a href="#cb32-612" aria-hidden="true" tabindex="-1"></a>  gradient <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> (y_hat <span class="sc">-</span> df<span class="sc">$</span>adelie)</span>
<span id="cb32-613"><a href="#cb32-613" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-614"><a href="#cb32-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gradient)</span>
<span id="cb32-615"><a href="#cb32-615" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-616"><a href="#cb32-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-617"><a href="#cb32-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-618"><a href="#cb32-618" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb32-619"><a href="#cb32-619" aria-hidden="true" tabindex="-1"></a>We must specify <span class="in">`type="2"`</span> in the <span class="in">`norm()`</span> function to specify that we want the Euclidean length of the vector.</span>
<span id="cb32-620"><a href="#cb32-620" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-621"><a href="#cb32-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-622"><a href="#cb32-622" aria-hidden="true" tabindex="-1"></a>Now we implement the gradient descent algorithm. We stop if the difference between the new parameter vector and old parameter vector is less than $10^{-6}$.</span>
<span id="cb32-623"><a href="#cb32-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-626"><a href="#cb32-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-627"><a href="#cb32-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb32-628"><a href="#cb32-628" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb32-629"><a href="#cb32-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-630"><a href="#cb32-630" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb32-631"><a href="#cb32-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-632"><a href="#cb32-632" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb32-633"><a href="#cb32-633" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb32-634"><a href="#cb32-634" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-635"><a href="#cb32-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-636"><a href="#cb32-636" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb32-637"><a href="#cb32-637" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb32-638"><a href="#cb32-638" aria-hidden="true" tabindex="-1"></a>  current_gradient <span class="ot">&lt;-</span> <span class="fu">gradient</span>(theta)</span>
<span id="cb32-639"><a href="#cb32-639" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-640"><a href="#cb32-640" aria-hidden="true" tabindex="-1"></a>  theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> (step_size <span class="sc">*</span> current_gradient)</span>
<span id="cb32-641"><a href="#cb32-641" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-642"><a href="#cb32-642" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">norm</span>(theta <span class="sc">-</span> theta_new, <span class="at">type=</span><span class="st">"2"</span>) <span class="sc">&lt;</span> <span class="fl">1e-6</span>) {</span>
<span id="cb32-643"><a href="#cb32-643" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb32-644"><a href="#cb32-644" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb32-645"><a href="#cb32-645" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb32-646"><a href="#cb32-646" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-647"><a href="#cb32-647" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-648"><a href="#cb32-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-649"><a href="#cb32-649" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"Number of iterations: {iter}"</span>))</span>
<span id="cb32-650"><a href="#cb32-650" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"Final parameter values: {as.numeric(theta)}"</span>))</span>
<span id="cb32-651"><a href="#cb32-651" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glue</span>(<span class="st">"`glm()` parameter values (for comparison): {as.numeric(coef(model_glm))}"</span>))</span>
<span id="cb32-652"><a href="#cb32-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-653"><a href="#cb32-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-654"><a href="#cb32-654" aria-hidden="true" tabindex="-1"></a>Again, we see that the results are very close to the <span class="in">`glm()`</span> results.</span>
<span id="cb32-655"><a href="#cb32-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-656"><a href="#cb32-656" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb32-657"><a href="#cb32-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-658"><a href="#cb32-658" aria-hidden="true" tabindex="-1"></a>Hopefully this post was helpful for understanding the inner workings of logistic regression and how the principles can be extended to other types of models. For example, Poisson regression is another type of generalized linear model just like logistic regression, where in that case we use the <span class="in">`exp`</span> function instead of the <span class="in">`expit`</span> function to constrain parameter values to lie in the range $<span class="co">[</span><span class="ot">0, \infty</span><span class="co">]</span>$.</span>
<span id="cb32-659"><a href="#cb32-659" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>