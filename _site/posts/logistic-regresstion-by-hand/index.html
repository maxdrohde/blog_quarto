<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.545">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Max Rohde">
<meta name="dcterms.date" content="2022-05-11">
<meta name="description" content="ADD DESCRIPTION HERE">
<title>Max Rohde - Logistic regression (by hand)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>
    .quarto-title-block .quarto-title-banner {
      color: black;
background: #f1f3f5;
    }
    </style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Max Rohde - Logistic regression (by hand)">
<meta name="twitter:description" content="ADD DESCRIPTION HERE">
<meta name="twitter:image" content="preview.png">
<meta name="twitter:creator" content="@max_d_rohde">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Max Rohde</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.pdf">Resume</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../anim.html">Animations</a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Logistic regression (by hand)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          ADD DESCRIPTION HERE
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Max Rohde </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 11, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#notes-to-self" id="toc-notes-to-self" class="nav-link active" data-scroll-target="#notes-to-self">Notes to self</a></li>
  <li><a href="#data-overview" id="toc-data-overview" class="nav-link" data-scroll-target="#data-overview">Data overview</a></li>
  <li><a href="#logistic-regression-overview" id="toc-logistic-regression-overview" class="nav-link" data-scroll-target="#logistic-regression-overview">Logistic regression overview</a></li>
  <li><a href="#logistic-regression-with-glm" id="toc-logistic-regression-with-glm" class="nav-link" data-scroll-target="#logistic-regression-with-glm">Logistic regression with <code>glm()</code></a></li>
  <li><a href="#logistic-regression-with-optim" id="toc-logistic-regression-with-optim" class="nav-link" data-scroll-target="#logistic-regression-with-optim">Logistic regression with <code>optim()</code></a></li>
  <li><a href="#logistic-regression-with-gradient-descent" id="toc-logistic-regression-with-gradient-descent" class="nav-link" data-scroll-target="#logistic-regression-with-gradient-descent">Logistic regression with gradient descent</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/maxdrohde/blog_quarto/edit/main/posts/logistic-regresstion-by-hand/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/maxdrohde/blog_quarto/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><section id="notes-to-self" class="level3"><h3 class="anchored" data-anchor-id="notes-to-self">Notes to self</h3>
<p>Different parts: - Show using the <code>glm</code> function - show using the likelihood by hand with optimize and nelder mead - show using the likelihood and gradient by hand with gradient descent - show using the likelihood and gradient by hand using newton raphson - show using autodiff with torch: https://rgiordan.github.io/code/2022/04/01/rtorch_example.html - compare timing</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com">gganimate</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>

<span class="co"># Set global ggplot theme</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_cowplot</a></span><span class="op">(</span>font_size<span class="op">=</span><span class="fl">12</span>,
                                 font_family <span class="op">=</span> <span class="st">"Source Sans Pro"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Load and rename data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelie"</span>, <span class="st">"Gentoo"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>adelie <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">adelie</span>, <span class="va">bill_length_mm</span><span class="op">:</span><span class="va">body_mass_g</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="data-overview" class="level1 page-columns page-full"><h1>Data overview</h1>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># View data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="kable-table">

<table>
<thead><tr>
<th style="text-align:left;">
species
</th>
<th style="text-align:right;">
adelie
</th>
<th style="text-align:right;">
bill_length_mm
</th>
<th style="text-align:right;">
bill_depth_mm
</th>
<th style="text-align:right;">
flipper_length_mm
</th>
<th style="text-align:right;">
body_mass_g
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
39.1
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
3750
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
39.5
</td>
<td style="text-align:right;">
17.4
</td>
<td style="text-align:right;">
186
</td>
<td style="text-align:right;">
3800
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
40.3
</td>
<td style="text-align:right;">
18.0
</td>
<td style="text-align:right;">
195
</td>
<td style="text-align:right;">
3250
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
36.7
</td>
<td style="text-align:right;">
19.3
</td>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
3450
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
39.3
</td>
<td style="text-align:right;">
20.6
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
3650
</td>
</tr>
<tr>
<td style="text-align:left;">
Adelie
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
17.8
</td>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
3625
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout-note column-page-right callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand to view detailed summary statistics for each variable
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/html.html">html</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/describe.html">describe</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript">
<!--
    function expand_collapse(id) {
       var e = document.getElementById(id);
       var f = document.getElementById(id+"_earrows");
       if(e.style.display == 'none'){
          e.style.display = 'block';
          f.innerHTML = '&#9650';
       }
       else {
          e.style.display = 'none';
          f.innerHTML = '&#9660';
       }
    }
//-->
</script><style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: 󅒐
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>
<title>df Descriptives</title>
<font color="MidnightBlue"><div align="center"><span style="font-weight:bold">df <br><br> 6  Variables   274  Observations</span></div></font> <hr class="thinhr">
<span style="font-weight:bold">species</span> <style>
 .hmisctable991502 {
 border: none;
 font-size: 85%;
 }
 .hmisctable991502 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable991502 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable991502">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>2</td>
</tr>
</tbody></table>
<pre style="font-size:85%;"> Value      Adelie Gentoo
 Frequency     151    123
 Proportion  0.551  0.449
 </pre>
 <hr class="thinhr">
<span style="font-weight:bold">adelie</span> <style>
 .hmisctable732358 {
 border: none;
 font-size: 85%;
 }
 .hmisctable732358 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable732358 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable732358">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Sum</th>
<th>Mean</th>
<th>Gmd</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>2</td>
<td>0.742</td>
<td>151</td>
<td>0.5511</td>
<td>0.4966</td>
</tr>
</tbody></table>
<hr class="thinhr">
<span style="font-weight:bold">bill_length_mm</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable997218 {
 border: none;
 font-size: 85%;
 }
 .hmisctable997218 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable997218 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable997218">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>146</td>
<td>1</td>
<td>42.7</td>
<td>5.944</td>
<td>35.43</td>
<td>36.20</td>
<td>38.35</td>
<td>42.00</td>
<td>46.68</td>
<td>49.80</td>
<td>50.73</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 32.1 33.1 33.5 34.0 34.1 ,  <font color="MidnightBlue">highest</font>: 53.4 54.3 55.1 55.9 59.6</span> <hr class="thinhr">
<span style="font-weight:bold">bill_depth_mm</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable957551 {
 border: none;
 font-size: 85%;
 }
 .hmisctable957551 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable957551 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable957551">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>78</td>
<td>1</td>
<td>16.84</td>
<td>2.317</td>
<td>13.80</td>
<td>14.20</td>
<td>15.00</td>
<td>17.00</td>
<td>18.50</td>
<td>19.30</td>
<td>20.03</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 13.1 13.2 13.3 13.4 13.5 ,  <font color="MidnightBlue">highest</font>: 20.6 20.7 21.1 21.2 21.5</span> <hr class="thinhr">
<span style="font-weight:bold">flipper_length_mm</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable192542 {
 border: none;
 font-size: 85%;
 }
 .hmisctable192542 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable192542 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable192542">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>54</td>
<td>0.999</td>
<td>202.2</td>
<td>17.23</td>
<td>181.0</td>
<td>184.0</td>
<td>190.0</td>
<td>198.0</td>
<td>215.0</td>
<td>222.0</td>
<td>226.7</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 172 174 176 178 179 ,  <font color="MidnightBlue">highest</font>: 226 228 229 230 231</span> <hr class="thinhr">
<span style="font-weight:bold">body_mass_g</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,%0A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" alt="image"></div> <style>
 .hmisctable157625 {
 border: none;
 font-size: 85%;
 }
 .hmisctable157625 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable157625 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
<table class="hmisctable157625">
<tbody><tr>
<th>n</th>
<th>missing</th>
<th>distinct</th>
<th>Info</th>
<th>Mean</th>
<th>Gmd</th>
<th>.05</th>
<th>.10</th>
<th>.25</th>
<th>.50</th>
<th>.75</th>
<th>.90</th>
<th>.95</th>
</tr>
<tr>
<td>274</td>
<td>0</td>
<td>89</td>
<td>1</td>
<td>4318</td>
<td>962.3</td>
<td>3091</td>
<td>3282</td>
<td>3600</td>
<td>4262</td>
<td>4950</td>
<td>5535</td>
<td>5700</td>
</tr>
</tbody></table>
<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 2850 2900 2925 2975 3000 ,  <font color="MidnightBlue">highest</font>: 5850 5950 6000 6050 6300</span> <hr class="thinhr">
</div>
</div>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">species</span><span class="op">)</span>,
                  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bill_length_mm"</span>,
                              <span class="st">"bill_depth_mm"</span>,
                              <span class="st">"flipper_length_mm"</span>,
                              <span class="st">"body_mass_g"</span><span class="op">)</span>,
                  title <span class="op">=</span> <span class="st">"Can these features distinguish Adelie and Gentoo penguins?"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page-right">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section><section id="logistic-regression-overview" class="level1"><h1>Logistic regression overview</h1>
</section><section id="logistic-regression-with-glm" class="level1 page-columns page-full"><h1>Logistic regression with <code>glm()</code>
</h1>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">model_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">adelie</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">body_mass_g</span>,
                 family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,
                 data<span class="op">=</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span>
<span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span><span class="op">(</span>bill_length_mm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">+</span><span class="fl">2</span>, <span class="fl">0.1</span><span class="op">)</span>,
         body_mass_g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">-</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">+</span><span class="fl">100</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">grid</span><span class="op">$</span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model_glm</span>, <span class="va">grid</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">grid</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_length_mm</span>,
      y<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span>, color<span class="op">=</span><span class="st">"black"</span>, shape<span class="op">=</span><span class="fl">21</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span>,
                       limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3000</span>, <span class="fl">6000</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Probability of Adelie\n"</span>,
       color <span class="op">=</span> <span class="st">"Species"</span>,
       x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>,
       y <span class="op">=</span> <span class="st">"Body mass (g)"</span>,
       title <span class="op">=</span> <span class="st">"Visualizing the predictions of the logistic regression model"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-page-right">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section><section id="logistic-regression-with-optim" class="level1"><h1>Logistic regression with <code>optim()</code>
</h1>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># This is a naive implementation that can overflow for large x</span>
<span class="co"># expit &lt;- function(x) exp(x) / (1 + exp(x))</span>

<span class="co"># Better to use the built-in version</span>
<span class="va">expit</span> <span class="op">&lt;-</span> <span class="va">plogis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">objective_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">{</span>
  
  <span class="co"># optim() expects the parameters as a single vector, so we set the coefficients</span>
  <span class="co"># as the elements of a vector called `parameters`</span>
  <span class="va">b0</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">b2</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  
  <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">b0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b1</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b2</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span>
  
  <span class="co"># Likelihood for each observation</span>
  <span class="co"># If the observation is Adelie, then the likelihood is the probability of Adelie</span>
  <span class="co"># If the observation is not Adelie (i.e., Gentoo), then the likelihood is the probability of not Adelie</span>
  <span class="co"># which is 1 - P(Adelie)</span>
  <span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">adelie</span><span class="op">==</span><span class="fl">1</span>,
                       <span class="fu">expit</span><span class="op">(</span><span class="va">linear_predictor</span><span class="op">)</span>,
                       <span class="fl">1</span><span class="op">-</span><span class="fu">expit</span><span class="op">(</span><span class="va">linear_predictor</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co"># Log-likelihood for each observation</span>
  <span class="va">log_likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span>
  
  <span class="co"># Joint log-likelihood for all the observations. Note the sum because</span>
  <span class="co"># multiplication is addition on the log-scale</span>
  <span class="va">total_log_likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">log_likelihood</span><span class="op">)</span>
  
  <span class="co"># the optim() function only minimizes, so we return the negative log-likelihood</span>
  <span class="co"># and then maximize it</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">-</span><span class="va">total_log_likelihood</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">optim_results</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html">optim</a></span><span class="op">(</span>par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,              <span class="co"># Initial values</span>
        fn <span class="op">=</span> <span class="va">objective_function</span>,   <span class="co"># Objective function to be minimized</span>
        method<span class="op">=</span><span class="st">"Nelder-Mead"</span><span class="op">)</span>      <span class="co"># Optimization method</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">optim_results</span><span class="op">$</span><span class="va">par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 58.074500372 -0.899844087 -0.004363435</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_glm</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) bill_length_mm    body_mass_g 
  58.074990649   -0.899869242   -0.004363412 </code></pre>
</div>
</div>
</section><section id="logistic-regression-with-gradient-descent" class="level1"><h1>Logistic regression with gradient descent</h1>
<p>You can find a nice derivation of the derivative of the negative log-likelihood for logistic regression <a href="https://web.stanford.edu/~jurafsky/slp3/5.pdf">here</a>.</p>
<p><span class="math display">\[\begin{align*}
(\hat{y}-y) \mathbf{x}_{j}
\end{align*}\]</span></p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span>, center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span>, center<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">model_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">adelie</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">body_mass_g</span>,
                 family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,
                 data<span class="op">=</span><span class="va">df</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">gradient</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">b0</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="va">b2</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  
  <span class="va">linear_predictor</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">b0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b1</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b2</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span>
  
  <span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="fu">expit</span><span class="op">(</span><span class="va">linear_predictor</span><span class="op">)</span>
  
  <span class="va">gradient</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="va">df</span><span class="op">$</span><span class="va">bill_length_mm</span>, <span class="va">df</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">y_hat</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">adelie</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gradient</span><span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">step_size</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>
<span class="va">iter</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="kw">while</span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">iter</span> <span class="op">&lt;-</span> <span class="va">iter</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="va">current_gradient</span> <span class="op">&lt;-</span> <span class="fu">gradient</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>
  
  <span class="va">theta_new</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">-</span> <span class="op">(</span><span class="va">step_size</span> <span class="op">*</span> <span class="va">current_gradient</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html">norm</a></span><span class="op">(</span><span class="va">theta</span> <span class="op">-</span> <span class="va">theta_new</span>, type<span class="op">=</span><span class="st">"2"</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-4</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">break</span>
  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span>
    <span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">theta_new</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 0</code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model_glm</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) bill_length_mm    body_mass_g 
      58.07499      -38.78022      -19.22516 </code></pre>
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><script src="https://utteranc.es/client.js" repo="maxdrohde/blog_quarto" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb27" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Logistic regression (by hand)</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co">  ADD DESCRIPTION HERE</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Max Rohde</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 05/11/2022</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> preview.png</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> show</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="an">freeze:</span><span class="co"> false</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="an">cache:</span><span class="co"> false</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> true</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">### Notes to self</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>Different parts:</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Show using the <span class="in">`glm`</span> function</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>show using the likelihood by hand with optimize and nelder mead</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>show using the likelihood and gradient by hand with gradient descent</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>show using the likelihood and gradient by hand using newton raphson</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>show using autodiff with torch: https://rgiordan.github.io/code/2022/04/01/rtorch_example.html</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>compare timing</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global ggplot theme</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(cowplot<span class="sc">::</span><span class="fu">theme_cowplot</span>(<span class="at">font_size=</span><span class="dv">12</span>,</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">font_family =</span> <span class="st">"Source Sans Pro"</span>))</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and rename data</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(penguins)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> penguins</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Adelie"</span>, <span class="st">"Gentoo"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">adelie =</span> <span class="fu">as.integer</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, adelie, bill_length_mm<span class="sc">:</span>body_mass_g) <span class="sc">%&gt;%</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data overview</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>:::{.callout-note .column-page-right collapse="true"}</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Expand to view detailed summary statistics for each variable</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span>(<span class="fu">describe</span>(df))</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color=</span>species),</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>                  <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"bill_length_mm"</span>,</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"bill_depth_mm"</span>,</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"flipper_length_mm"</span>,</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"body_mass_g"</span>),</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"Can these features distinguish Adelie and Gentoo penguins?"</span>)</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression overview</span></span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression with `glm()`</span></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>model_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(adelie <span class="sc">~</span> bill_length_mm <span class="sc">+</span> body_mass_g,</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>df)</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">bill_length_mm =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df<span class="sc">$</span>bill_length_mm)<span class="sc">-</span><span class="dv">2</span>, <span class="fu">max</span>(df<span class="sc">$</span>bill_length_mm)<span class="sc">+</span><span class="dv">2</span>, <span class="fl">0.1</span>),</span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a>         <span class="at">body_mass_g =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df<span class="sc">$</span>body_mass_g)<span class="sc">-</span><span class="dv">100</span>, <span class="fu">max</span>(df<span class="sc">$</span>body_mass_g)<span class="sc">+</span><span class="dv">100</span>, <span class="fl">0.5</span>))</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_glm, grid, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>grid <span class="sc">%&gt;%</span></span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>bill_length_mm,</span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>body_mass_g) <span class="sc">+</span></span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>predicted)) <span class="sc">+</span></span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color=</span>species)) <span class="sc">+</span></span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>df, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">shape=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>),</span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">3000</span>, <span class="dv">6000</span>, <span class="dv">500</span>)) <span class="sc">+</span></span>
<span id="cb27-139"><a href="#cb27-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Probability of Adelie</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb27-140"><a href="#cb27-140" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb27-141"><a href="#cb27-141" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Bill length (mm)"</span>,</span>
<span id="cb27-142"><a href="#cb27-142" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Body mass (g)"</span>,</span>
<span id="cb27-143"><a href="#cb27-143" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Visualizing the predictions of the logistic regression model"</span>) <span class="sc">+</span></span>
<span id="cb27-144"><a href="#cb27-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))</span>
<span id="cb27-145"><a href="#cb27-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-146"><a href="#cb27-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-147"><a href="#cb27-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-148"><a href="#cb27-148" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression with `optim()`</span></span>
<span id="cb27-149"><a href="#cb27-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-152"><a href="#cb27-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-153"><a href="#cb27-153" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a naive implementation that can overflow for large x</span></span>
<span id="cb27-154"><a href="#cb27-154" aria-hidden="true" tabindex="-1"></a><span class="co"># expit &lt;- function(x) exp(x) / (1 + exp(x))</span></span>
<span id="cb27-155"><a href="#cb27-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-156"><a href="#cb27-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Better to use the built-in version</span></span>
<span id="cb27-157"><a href="#cb27-157" aria-hidden="true" tabindex="-1"></a>expit <span class="ot">&lt;-</span> plogis</span>
<span id="cb27-158"><a href="#cb27-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-159"><a href="#cb27-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-160"><a href="#cb27-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-163"><a href="#cb27-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-164"><a href="#cb27-164" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(parameters){</span>
<span id="cb27-165"><a href="#cb27-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-166"><a href="#cb27-166" aria-hidden="true" tabindex="-1"></a>  <span class="co"># optim() expects the parameters as a single vector, so we set the coefficients</span></span>
<span id="cb27-167"><a href="#cb27-167" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as the elements of a vector called `parameters`</span></span>
<span id="cb27-168"><a href="#cb27-168" aria-hidden="true" tabindex="-1"></a>  b0 <span class="ot">&lt;-</span> parameters[<span class="dv">1</span>]</span>
<span id="cb27-169"><a href="#cb27-169" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> parameters[<span class="dv">2</span>]</span>
<span id="cb27-170"><a href="#cb27-170" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> parameters[<span class="dv">3</span>]</span>
<span id="cb27-171"><a href="#cb27-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-172"><a href="#cb27-172" aria-hidden="true" tabindex="-1"></a>  linear_predictor <span class="ot">&lt;-</span> (b0) <span class="sc">+</span> (b1<span class="sc">*</span>df<span class="sc">$</span>bill_length_mm) <span class="sc">+</span> (b2<span class="sc">*</span>df<span class="sc">$</span>body_mass_g)</span>
<span id="cb27-173"><a href="#cb27-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-174"><a href="#cb27-174" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Likelihood for each observation</span></span>
<span id="cb27-175"><a href="#cb27-175" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the observation is Adelie, then the likelihood is the probability of Adelie</span></span>
<span id="cb27-176"><a href="#cb27-176" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the observation is not Adelie (i.e., Gentoo), then the likelihood is the probability of not Adelie</span></span>
<span id="cb27-177"><a href="#cb27-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># which is 1 - P(Adelie)</span></span>
<span id="cb27-178"><a href="#cb27-178" aria-hidden="true" tabindex="-1"></a>  likelihood <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>adelie<span class="sc">==</span><span class="dv">1</span>,</span>
<span id="cb27-179"><a href="#cb27-179" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">expit</span>(linear_predictor),</span>
<span id="cb27-180"><a href="#cb27-180" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span><span class="sc">-</span><span class="fu">expit</span>(linear_predictor))</span>
<span id="cb27-181"><a href="#cb27-181" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-182"><a href="#cb27-182" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Log-likelihood for each observation</span></span>
<span id="cb27-183"><a href="#cb27-183" aria-hidden="true" tabindex="-1"></a>  log_likelihood <span class="ot">&lt;-</span> <span class="fu">log</span>(likelihood)</span>
<span id="cb27-184"><a href="#cb27-184" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-185"><a href="#cb27-185" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Joint log-likelihood for all the observations. Note the sum because</span></span>
<span id="cb27-186"><a href="#cb27-186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># multiplication is addition on the log-scale</span></span>
<span id="cb27-187"><a href="#cb27-187" aria-hidden="true" tabindex="-1"></a>  total_log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(log_likelihood)</span>
<span id="cb27-188"><a href="#cb27-188" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-189"><a href="#cb27-189" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the optim() function only minimizes, so we return the negative log-likelihood</span></span>
<span id="cb27-190"><a href="#cb27-190" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and then maximize it</span></span>
<span id="cb27-191"><a href="#cb27-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>total_log_likelihood)</span>
<span id="cb27-192"><a href="#cb27-192" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-193"><a href="#cb27-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-194"><a href="#cb27-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-197"><a href="#cb27-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-198"><a href="#cb27-198" aria-hidden="true" tabindex="-1"></a>optim_results <span class="ot">&lt;-</span></span>
<span id="cb27-199"><a href="#cb27-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">optim</span>(<span class="at">par=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),              <span class="co"># Initial values</span></span>
<span id="cb27-200"><a href="#cb27-200" aria-hidden="true" tabindex="-1"></a>        <span class="at">fn =</span> objective_function,   <span class="co"># Objective function to be minimized</span></span>
<span id="cb27-201"><a href="#cb27-201" aria-hidden="true" tabindex="-1"></a>        <span class="at">method=</span><span class="st">"Nelder-Mead"</span>)      <span class="co"># Optimization method</span></span>
<span id="cb27-202"><a href="#cb27-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-203"><a href="#cb27-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-206"><a href="#cb27-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-207"><a href="#cb27-207" aria-hidden="true" tabindex="-1"></a>optim_results<span class="sc">$</span>par</span>
<span id="cb27-208"><a href="#cb27-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-211"><a href="#cb27-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-212"><a href="#cb27-212" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model_glm)</span>
<span id="cb27-213"><a href="#cb27-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-214"><a href="#cb27-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-215"><a href="#cb27-215" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic regression with gradient descent</span></span>
<span id="cb27-216"><a href="#cb27-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-217"><a href="#cb27-217" aria-hidden="true" tabindex="-1"></a>You can find a nice derivation of the derivative of the negative log-likelihood for logistic regression <span class="co">[</span><span class="ot">here</span><span class="co">](https://web.stanford.edu/~jurafsky/slp3/5.pdf)</span>.</span>
<span id="cb27-218"><a href="#cb27-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-219"><a href="#cb27-219" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb27-220"><a href="#cb27-220" aria-hidden="true" tabindex="-1"></a>(\hat{y}-y) \mathbf{x}_{j}</span>
<span id="cb27-221"><a href="#cb27-221" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb27-222"><a href="#cb27-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-225"><a href="#cb27-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-226"><a href="#cb27-226" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>bill_length_mm <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>bill_length_mm, <span class="at">center=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb27-227"><a href="#cb27-227" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>body_mass_g <span class="ot">&lt;-</span> <span class="fu">scale</span>(df<span class="sc">$</span>body_mass_g, <span class="at">center=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span>
<span id="cb27-228"><a href="#cb27-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-229"><a href="#cb27-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-232"><a href="#cb27-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-233"><a href="#cb27-233" aria-hidden="true" tabindex="-1"></a>model_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(adelie <span class="sc">~</span> bill_length_mm <span class="sc">+</span> body_mass_g,</span>
<span id="cb27-234"><a href="#cb27-234" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb27-235"><a href="#cb27-235" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>df)</span>
<span id="cb27-236"><a href="#cb27-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-237"><a href="#cb27-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-240"><a href="#cb27-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-241"><a href="#cb27-241" aria-hidden="true" tabindex="-1"></a>gradient <span class="ot">&lt;-</span> <span class="cf">function</span>(parameters){</span>
<span id="cb27-242"><a href="#cb27-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-243"><a href="#cb27-243" aria-hidden="true" tabindex="-1"></a>  b0 <span class="ot">&lt;-</span> parameters[<span class="dv">1</span>]</span>
<span id="cb27-244"><a href="#cb27-244" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> parameters[<span class="dv">2</span>]</span>
<span id="cb27-245"><a href="#cb27-245" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> parameters[<span class="dv">3</span>]</span>
<span id="cb27-246"><a href="#cb27-246" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-247"><a href="#cb27-247" aria-hidden="true" tabindex="-1"></a>  linear_predictor <span class="ot">&lt;-</span> (b0) <span class="sc">+</span> (b1<span class="sc">*</span>df<span class="sc">$</span>bill_length_mm) <span class="sc">+</span> (b2<span class="sc">*</span>df<span class="sc">$</span>body_mass_g)</span>
<span id="cb27-248"><a href="#cb27-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-249"><a href="#cb27-249" aria-hidden="true" tabindex="-1"></a>  y_hat <span class="ot">&lt;-</span> <span class="fu">expit</span>(linear_predictor)</span>
<span id="cb27-250"><a href="#cb27-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-251"><a href="#cb27-251" aria-hidden="true" tabindex="-1"></a>  gradient <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(df)), df<span class="sc">$</span>bill_length_mm, df<span class="sc">$</span>body_mass_g)) <span class="sc">%*%</span> (y_hat <span class="sc">-</span> df<span class="sc">$</span>adelie)) <span class="sc">/</span> <span class="fu">nrow</span>(df)</span>
<span id="cb27-252"><a href="#cb27-252" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-253"><a href="#cb27-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(gradient)</span>
<span id="cb27-254"><a href="#cb27-254" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-255"><a href="#cb27-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-256"><a href="#cb27-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-259"><a href="#cb27-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-260"><a href="#cb27-260" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fl">0.0001</span></span>
<span id="cb27-261"><a href="#cb27-261" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb27-262"><a href="#cb27-262" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-263"><a href="#cb27-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-264"><a href="#cb27-264" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb27-265"><a href="#cb27-265" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb27-266"><a href="#cb27-266" aria-hidden="true" tabindex="-1"></a>  current_gradient <span class="ot">&lt;-</span> <span class="fu">gradient</span>(theta)</span>
<span id="cb27-267"><a href="#cb27-267" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-268"><a href="#cb27-268" aria-hidden="true" tabindex="-1"></a>  theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> (step_size <span class="sc">*</span> current_gradient)</span>
<span id="cb27-269"><a href="#cb27-269" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-270"><a href="#cb27-270" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">norm</span>(theta <span class="sc">-</span> theta_new, <span class="at">type=</span><span class="st">"2"</span>) <span class="sc">&lt;</span> <span class="fl">1e-4</span>) {</span>
<span id="cb27-271"><a href="#cb27-271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb27-272"><a href="#cb27-272" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb27-273"><a href="#cb27-273" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb27-274"><a href="#cb27-274" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(theta)</span>
<span id="cb27-275"><a href="#cb27-275" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-276"><a href="#cb27-276" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-277"><a href="#cb27-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-278"><a href="#cb27-278" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iter)</span>
<span id="cb27-279"><a href="#cb27-279" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(theta)</span>
<span id="cb27-280"><a href="#cb27-280" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(model_glm))</span>
<span id="cb27-281"><a href="#cb27-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-282"><a href="#cb27-282" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>